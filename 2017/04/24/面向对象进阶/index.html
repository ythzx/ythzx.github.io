<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python 面向对象进阶 | Peter&#39;s Blog Center</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="Python" />
  
  
  
  
  <meta name="description" content="1 isinstance 和issubclass">
<meta property="og:type" content="article">
<meta property="og:title" content="Python 面向对象进阶">
<meta property="og:url" content="https://github.com/ythzx/ythzx.github.io/2017/04/24/面向对象进阶/index.html">
<meta property="og:site_name" content="Peter's Blog Center">
<meta property="og:description" content="1 isinstance 和issubclass">
<meta property="og:updated_time" content="2017-05-19T13:56:27.363Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python 面向对象进阶">
<meta name="twitter:description" content="1 isinstance 和issubclass">
  
    <link rel="alternate" href="/atom.xml" title="Peter&#39;s Blog Center" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/hiero.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="Peter&#39;s Blog Center" rel="home"> Peter&#39;s Blog Center </a>
            
          </h1>

          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>




  <div id="container" style='background: rgba(255,255,255,0.5);'>
    <div id="wrap" style='background: rgba(255,255,255,0.5);'>
            
      <div id="content" class="outer" style='background: rgba(255,255,255,0.5);'>
        
          <section id="main" style="float:none;"><article id="post-面向对象进阶" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      Python 面向对象进阶
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/04/24/面向对象进阶/" class="article-date">
	  <time datetime="2017-04-24T10:49:44.864Z" itemprop="datePublished">四月 24, 2017</time>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-isinstance-和issubclass"><a href="#1-isinstance-和issubclass" class="headerlink" title="1 isinstance 和issubclass"></a>1 isinstance 和issubclass</h2><a id="more"></a>
<h3 id="instance-判断该对象是否是类的对象"><a href="#instance-判断该对象是否是类的对象" class="headerlink" title="instance:判断该对象是否是类的对象"></a>instance:判断该对象是否是类的对象</h3><p><strong> isinstance（obj,Foo） </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">x = []</div><div class="line">print(isinstance(x,list))</div></pre></td></tr></table></figure>
<p>结果：<br>True</p>
<h3 id="issubclass-判断是否是继承"><a href="#issubclass-判断是否是继承" class="headerlink" title="issubclass:判断是否是继承"></a>issubclass:判断是否是继承</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span><span class="params">(Foo)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line">print(issubclass(Bar,Foo))</div></pre></td></tr></table></figure>
<p>结果：<br>True</p>
<p>通过下面的方式也可以查看<br>print(Bar.<strong>base</strong>)   </p>
<h2 id="2-反射"><a href="#2-反射" class="headerlink" title="2 反射"></a>2 反射</h2><blockquote>
<p>反射是Smi首次提出的，主要指程序可以访问、检测和修改它本身状态行为的一种能力，也可以叫做<strong>自省</strong></p>
</blockquote>
<h3 id="2-1面向对象中的反射"><a href="#2-1面向对象中的反射" class="headerlink" title="2.1面向对象中的反射"></a>2.1面向对象中的反射</h3><p>面向对象中的反射，是通过<strong>字符串形式操作对象</strong>的属性，<strong>Python中一切都是对象</strong>，都可以使用对象</p>
<p>Python中通过<strong>hasattr、getattr、setattr、deltattr</strong>实现自省的函数，适用于<strong>类和对象</strong>（一切都是对象）</p>
<p>反射就是把字符串反射成相应的命令</p>
<h4 id="hasattr"><a href="#hasattr" class="headerlink" title="hasattr"></a>hasattr</h4><p>查看类和对象中是否有name,用字符串表示，实例在找的时候首先从自身找，自身没有从类找。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></div><div class="line">    name = <span class="string">'aaa'</span></div><div class="line">f1 =Foo()</div><div class="line">print(hasattr(Foo,<span class="string">'name'</span>))</div><div class="line">print(hasattr(f1,<span class="string">'name'</span>))</div></pre></td></tr></table></figure></p>
<p>结果：<br>True<br>True</p>
<h4 id="setattr"><a href="#setattr" class="headerlink" title="setattr"></a>setattr</h4><p>setattr是设置属性，setattr(x,y,z)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></div><div class="line">    name = <span class="string">'aaa'</span></div><div class="line">f1 =Foo()</div><div class="line"></div><div class="line">setattr(Foo,<span class="string">'age'</span>,<span class="number">18</span>)</div><div class="line">print(Foo,<span class="string">'age'</span>)</div><div class="line">print(f1,<span class="string">'age'</span>)</div></pre></td></tr></table></figure></p>
<h4 id="deltattr"><a href="#deltattr" class="headerlink" title="deltattr"></a>deltattr</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">print(Foo.__dict__)</div><div class="line">delattr(Foo,<span class="string">'name'</span>)</div><div class="line">print(Foo.__dict__)   </div><div class="line">print(hasattr(f1,<span class="string">'name'</span>))</div></pre></td></tr></table></figure>
<p>结果：<br>False<br>通过打印类的名称空间可以查看到name已经没有了</p>
<h4 id="getattr"><a href="#getattr" class="headerlink" title="getattr"></a>getattr</h4><p>getattr是查找那个属性，并把命名它的值获得，实际的原理是通过获得字典中的key,然后获得value</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span>:</span></div><div class="line">    country = <span class="string">'china'</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name)</span>:</span></div><div class="line">        self.name=name</div><div class="line"></div><div class="line">p = People(<span class="string">'aaa'</span>)</div><div class="line">print(hasattr(p,<span class="string">'name'</span>))</div><div class="line">print(<span class="string">'name'</span> <span class="keyword">in</span> p.__dict__)  <span class="comment"># 执行的效果是一样的e</span></div><div class="line"></div><div class="line">print(hasattr(p,<span class="string">'country'</span>))</div><div class="line">print(hasattr(People,<span class="string">'country'</span>))</div><div class="line"></div><div class="line">print(getattr(p,<span class="string">'country'</span>))</div><div class="line">print(getattr(p,<span class="string">'__init__'</span>))</div><div class="line">print(getattr(People,<span class="string">'country'</span>))</div></pre></td></tr></table></figure>
<h3 id="2-3模块的反射"><a href="#2-3模块的反射" class="headerlink" title="2.3模块的反射"></a>2.3模块的反射</h3><p>Python中一切皆对象，模块文件等都是对象<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">s1</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">s2</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">pass</span></div><div class="line">this_module = sys.modules[__name__]</div><div class="line">print(hasattr(this_module,<span class="string">'s1'</span>))</div><div class="line">print(getattr(this_module,<span class="string">'s1'</span>))</div></pre></td></tr></table></figure></p>
<ul>
<li>结果：<br>True</li>
</ul>
<p>function s1 at 0x00000000005F3E18</p>
<h3 id="2-4-使用反射的好处"><a href="#2-4-使用反射的好处" class="headerlink" title="2.4 使用反射的好处"></a>2.4 使用反射的好处</h3><h4 id="2-4-1-实现可拔插机制"><a href="#2-4-1-实现可拔插机制" class="headerlink" title="2.4.1 实现可拔插机制"></a>2.4.1 实现可拔插机制</h4><p>可以事先定义好接口，接口只有在被完成后才会真正执行，这实现了即插即用，<br>这其实是一种‘后期绑定’，什么意思？即你可以事先把主要的逻辑写好（只定义接口），<br>然后后期再去实现接口的功能</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 第一个人负责的代码</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FtpClient</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,addr)</span>:</span></div><div class="line">        print(<span class="string">"正在连接服务器%s"</span> % addr)</div><div class="line">        self.addr = addr</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 第二个人引用的代码</span></div><div class="line">f1 = FtpClient(<span class="string">"192.168.0.1"</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> hasattr(f1, <span class="string">'get'</span>):</div><div class="line">    func = getattr(f1, <span class="string">'get'</span>)</div><div class="line">    func()</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    print(<span class="string">"不存在此方法"</span>)</div><div class="line">    print(<span class="string">"处理其他逻辑"</span>)</div></pre></td></tr></table></figure>
<p> 第一个人的代码只提供了接口，并没有写完，但是第二个人要用第一个人的代码中，通过自省进行判断，后面的人就可以直接拿来用了   </p>
<h3 id="2-4-2-动态导入模块"><a href="#2-4-2-动态导入模块" class="headerlink" title="2.4.2 动态导入模块"></a>2.4.2 动态导入模块</h3><p>动态导入模块（基于反射当前模块成员）</p>
<p>![<a href="http://images2015.cnblogs.com/blog/658994/201705/658994-20170519163027791-265304832.png" target="_blank" rel="external">http://images2015.cnblogs.com/blog/658994/201705/658994-20170519163027791-265304832.png</a>]   </p>
<h2 id="3-内置attr"><a href="#3-内置attr" class="headerlink" title="3 内置attr"></a>3 内置attr</h2><h3 id="getattr-1"><a href="#getattr-1" class="headerlink" title="getattr"></a><strong>getattr</strong></h3><p> <strong><strong>getattr</strong>只有在调用的属性不存在的时候才会触发</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name)</span>:</span></div><div class="line">        self.name = name</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, item)</span>:</span></div><div class="line">        print(<span class="string">"getattr--%s %s"</span>%(item,type(item)))</div><div class="line"></div><div class="line">f = Foo(<span class="string">'aaa'</span>)</div><div class="line">print(f.xxx)</div></pre></td></tr></table></figure></p>
<ul>
<li>结果：<br><em>getattr–xxx     class ‘str’<br>None</em></li>
</ul>
<h3 id="setattr-1"><a href="#setattr-1" class="headerlink" title="setattr"></a><strong>setattr</strong></h3><p><strong><strong>setattr</strong>添加/修改属性会触发它的执行</strong><br><strong>本质是修改的 self.<strong>dict</strong>[key]</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x)</span>:</span></div><div class="line">        self.name=x</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span><span class="params">(self, key, value)</span>:</span>  <span class="comment"># 与上面的对应关系是self--self,name--key,x--value</span></div><div class="line">        self.__dict__[key]=value  <span class="comment"># 真正修改的是__dict__中的内容</span></div><div class="line">f1 = Foo(<span class="string">'aaa'</span>)</div><div class="line">f1.x=<span class="string">'bbb'</span>   <span class="comment"># 修改属性</span></div><div class="line">f1.age=<span class="number">18</span>  <span class="comment"># 增加属性</span></div><div class="line">print(f1.__dict__) <span class="comment"># 在名称对象的名称空间中可以显示</span></div></pre></td></tr></table></figure>
<h3 id="deltattr-1"><a href="#deltattr-1" class="headerlink" title="deltattr"></a><strong>deltattr</strong></h3><p><strong>只有删除属性的时候才会触发<strong>deltatr</strong>的执行</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x)</span>:</span></div><div class="line">        self.name=x</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span><span class="params">(self, key, value)</span>:</span>  <span class="comment"># 与上面的对应关系是self--self,name--key,x--value</span></div><div class="line">        self.__dict__[key]=value  <span class="comment"># 真正修改的是__dict__中的内容</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__delattr__</span><span class="params">(self, item)</span>:</span></div><div class="line">        self.__dict__.pop(item)</div><div class="line">f1=Foo(<span class="string">'aaa'</span>)</div><div class="line">print(f1.__dict__)</div><div class="line"><span class="keyword">del</span> f1.name</div><div class="line">print(f1.__dict__)</div></pre></td></tr></table></figure></p>
<p><strong>结果：<br>{‘name’: ‘aaa’}<br>{}</strong></p>
<h3 id="4-反射的应用"><a href="#4-反射的应用" class="headerlink" title="4 反射的应用"></a>4 反射的应用</h3><h4 id="4-1-可插拔机制"><a href="#4-1-可插拔机制" class="headerlink" title="4.1 可插拔机制"></a>4.1 可插拔机制</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#客户端</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FtpClient</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,addr)</span>:</span></div><div class="line">        print(<span class="string">'正在连接服务器[%s]'</span>%addr)</div><div class="line">        self.addr = addr</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'get'</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'test'</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#服务端，需要使用客户端的内容</span></div><div class="line"><span class="keyword">import</span> ftpclient  <span class="comment"># 导入test模块（这里是文件）</span></div><div class="line"><span class="comment"># f1 = FtpClient('192.168.1.1')  # wrong</span></div><div class="line">f1=ftpclient.FtpClient(<span class="string">'192.168.1.1'</span>)   <span class="comment">#这里的对象是文件，即ftpclient,对这个对象进行实例化</span></div><div class="line"><span class="keyword">if</span> hasattr(f1,<span class="string">'get'</span>):  <span class="comment"># 首先看是否有这个功能</span></div><div class="line">    func_get=getattr(f1,<span class="string">'get'</span>)  <span class="comment"># getattr是获得相应的内存地址</span></div><div class="line">    func_get()</div><div class="line"><span class="keyword">else</span>:  <span class="comment"># else预语言中是真正的逻辑</span></div><div class="line">    print(<span class="string">'其他逻辑'</span>)</div></pre></td></tr></table></figure>
<h4 id="4-2-通过字符串导入模块"><a href="#4-2-通过字符串导入模块" class="headerlink" title="4.2 通过字符串导入模块"></a>4.2 通过字符串导入模块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">m = input(<span class="string">"输入你要导入的模块"</span>)</div><div class="line">m1 = __import__(m)</div><div class="line">print(m1)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> importlib</div><div class="line">t = importlib.import_module(<span class="string">'time'</span>)</div><div class="line">print(t.time)</div></pre></td></tr></table></figure>
<h3 id="5-二次加工标准类型（包装）"><a href="#5-二次加工标准类型（包装）" class="headerlink" title="5 二次加工标准类型（包装）"></a>5 二次加工标准类型（包装）</h3><p>Python内部已经有了标准的数据类型和内置方法，但是在很多的情况下，我们需要对数据类型进行自己定制，这几用到了继承和派生的知识</p>
<p><strong>对append添加限制，只能添加数字类型的</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span><span class="params">(list)</span>:</span> <span class="comment"># List 继承了列表list</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">append</span><span class="params">(self, p_object)</span>:</span>  <span class="comment"># 仅仅对append进行修改</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> isinstance(p_object,int):  <span class="comment">#　限制数据类型</span></div><div class="line">            <span class="keyword">raise</span> TypeError(<span class="string">'must be int'</span>)</div><div class="line">        super().append(p_object)  <span class="comment"># 真正的修改,super是对父类进行修改</span></div><div class="line">l = list([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line">print(l)</div><div class="line">l.append(<span class="number">4</span>)   <span class="comment"># 这里是对属性进行修改，实际是对类进行修改</span></div><div class="line">print(l)</div></pre></td></tr></table></figure></p>
<p><strong>结果：<br>[1, 2, 3]<br>[1, 2, 3, 4]</strong></p>
<p><strong>上面的情况仅仅是对append进行了修改并添加了限制，list的其他的属性如insert是没有限制的</strong></p>
<h3 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h3><p><strong>授权是包装的一个特性，上面的情况是通过继承来实现的，但是函数是不能继承的</strong></p>
<p>授权的过程是所有更新的功能都是由新类的某部分来处理，已经存在的就授权给对象的默认属性</p>
<p><strong>实现授权的关键点就是覆盖<strong>getattr</strong>方法</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Open</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,filepath,mode=<span class="string">'r'</span>,encoding=<span class="string">'utf-8'</span>)</span>:</span></div><div class="line">        self.x = open(filepath,mode=mode,encoding=encoding)  <span class="comment"># self.x是文件句柄 拿到文件中的内容</span></div><div class="line">        self.filepath=filepath</div><div class="line">        self.mode=mode</div><div class="line">        self.encoding=encoding</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(self,line)</span>:</span>  <span class="comment"># 在类中新建write功能</span></div><div class="line">        t=time.strftime(<span class="string">'%Y-%m-%d %X'</span>)</div><div class="line">        self.x.write(<span class="string">"%s %s"</span> %(t,line))  <span class="comment"># self.x存放的是文件句柄</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, item)</span>:</span>  <span class="comment"># 通过getattr实现的叫做授权</span></div><div class="line">        <span class="comment"># print('----&gt;',item,type(item))  # 测试查看类型</span></div><div class="line">        <span class="keyword">return</span> getattr(self.x,item)  <span class="comment"># 从一个文件对象获得 字符串   现在获得的是self.x 相应方法的地址</span></div><div class="line">f=Open(<span class="string">'b.txt'</span>,<span class="string">'w'</span>) <span class="comment">#实例化一个对象 传入相应的参数</span></div><div class="line">f.write(<span class="string">'123\n'</span>)   <span class="comment">#Open没有实际的writearttribute</span></div><div class="line"></div><div class="line">f.write(<span class="string">'123\n'</span>)</div><div class="line">f.write(<span class="string">'123\n'</span>)</div><div class="line">f.write(<span class="string">'123\n'</span>)</div><div class="line">f.write(<span class="string">'123\n'</span>)</div><div class="line">f.write(<span class="string">'123\n'</span>)</div><div class="line">f.write(<span class="string">'123\n'</span>)</div></pre></td></tr></table></figure>
<p>这样就能在文件中添加了带有时间的内容</p>
<p>对文件进行读操作：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">f=Open(<span class="string">'b.txt'</span>,<span class="string">'r'</span>)  <span class="comment"># 重新实例化</span></div><div class="line">res = f.read()<span class="comment"># f.read实际是self.x 的方法</span></div><div class="line">print(res)</div><div class="line">f.seek(<span class="number">0</span>)  <span class="comment">#此时光标位于文件的最后</span></div><div class="line">print(f.read())  <span class="comment">#这样就可以重新读文件</span></div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li></ul>

      
        
	<div id="comment">
	
	<!-- 多说评论框 start -->
	 <div class="ds-thread" data-thread-key="/2017/04/24/面向对象进阶/" data-title="Python 面向对象进阶" data-url="https://github.com/ythzx/ythzx.github.io/2017/04/24/面向对象进阶/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"ythzx"};
	  (function() {
	    var ds = document.createElement('script');
	    ds.type = 'text/javascript';ds.async = true;
	    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	    ds.charset = 'UTF-8';
	    (document.getElementsByTagName('head')[0] 
	     || document.getElementsByTagName('body')[0]).appendChild(ds);
	  })();
	  </script>
	<!-- 多说公共JS代码 end -->
	
	</div>
	<link rel="stylesheet" href="/css/comment.css">


      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/04/25/Python面向对象进阶2/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Python 面向对象进阶2
        
      </div>
    </a>
  
  
    <a href="/2017/04/22/Python 静态方法 类方法/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Python 静态方法 类方法</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
      <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-isinstance-和issubclass"><span class="nav-number">1.</span> <span class="nav-text">1 isinstance 和issubclass</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#instance-判断该对象是否是类的对象"><span class="nav-number">1.1.</span> <span class="nav-text">instance:判断该对象是否是类的对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#issubclass-判断是否是继承"><span class="nav-number">1.2.</span> <span class="nav-text">issubclass:判断是否是继承</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-反射"><span class="nav-number">2.</span> <span class="nav-text">2 反射</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1面向对象中的反射"><span class="nav-number">2.1.</span> <span class="nav-text">2.1面向对象中的反射</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#hasattr"><span class="nav-number">2.1.1.</span> <span class="nav-text">hasattr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setattr"><span class="nav-number">2.1.2.</span> <span class="nav-text">setattr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#deltattr"><span class="nav-number">2.1.3.</span> <span class="nav-text">deltattr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getattr"><span class="nav-number">2.1.4.</span> <span class="nav-text">getattr</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3模块的反射"><span class="nav-number">2.2.</span> <span class="nav-text">2.3模块的反射</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-使用反射的好处"><span class="nav-number">2.3.</span> <span class="nav-text">2.4 使用反射的好处</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-实现可拔插机制"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.4.1 实现可拔插机制</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-2-动态导入模块"><span class="nav-number">2.4.</span> <span class="nav-text">2.4.2 动态导入模块</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-内置attr"><span class="nav-number">3.</span> <span class="nav-text">3 内置attr</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#getattr-1"><span class="nav-number">3.1.</span> <span class="nav-text">getattr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setattr-1"><span class="nav-number">3.2.</span> <span class="nav-text">setattr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deltattr-1"><span class="nav-number">3.3.</span> <span class="nav-text">deltattr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-反射的应用"><span class="nav-number">3.4.</span> <span class="nav-text">4 反射的应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-可插拔机制"><span class="nav-number">3.4.1.</span> <span class="nav-text">4.1 可插拔机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-通过字符串导入模块"><span class="nav-number">3.4.2.</span> <span class="nav-text">4.2 通过字符串导入模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-二次加工标准类型（包装）"><span class="nav-number">3.5.</span> <span class="nav-text">5 二次加工标准类型（包装）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#授权"><span class="nav-number">3.6.</span> <span class="nav-text">授权</span></a></li></ol></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2018 Peter&#39;s Blog Center All Rights Reserved.
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>






<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?93b40df12317201527431272f20ac28a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
  

  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>


  <script type="text/javascript" color="33,33,33" zindex="-1" opacity="1" count="80" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
