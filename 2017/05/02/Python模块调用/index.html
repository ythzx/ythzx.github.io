<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>python模块调用 | Peter&#39;s Blog Center</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="Python" />
  
  
  
  
  <meta name="description" content="1 模块">
<meta property="og:type" content="article">
<meta property="og:title" content="Python模块调用">
<meta property="og:url" content="https://github.com/ythzx/ythzx.github.io/2017/05/02/Python模块调用/index.html">
<meta property="og:site_name" content="Peter's Blog Center">
<meta property="og:description" content="1 模块">
<meta property="og:updated_time" content="2017-05-03T08:06:16.694Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python模块调用">
<meta name="twitter:description" content="1 模块">
  
    <link rel="alternate" href="/atom.xml" title="Peter&#39;s Blog Center" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/hiero.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="Peter&#39;s Blog Center" rel="home"> Peter&#39;s Blog Center </a>
            
          </h1>

          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>




  <div id="container" style='background: rgba(255,255,255,0.5);'>
    <div id="wrap" style='background: rgba(255,255,255,0.5);'>
            
      <div id="content" class="outer" style='background: rgba(255,255,255,0.5);'>
        
          <section id="main" style="float:none;"><article id="post-Python模块调用" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      Python模块调用
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/05/02/Python模块调用/" class="article-date">
	  <time datetime="2017-05-02T09:43:32.712Z" itemprop="datePublished">五月 2, 2017</time>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-模块"><a href="#1-模块" class="headerlink" title="1 模块"></a>1 模块</h2><a id="more"></a>
<p>一个模块是包含了Python定义和声明的文件，<strong>文件名</strong>，就是<strong>模块名字</strong>加上py 后缀<br>把定义的函数、变量保存到文件中，通过Python test.py的方式执行，test.py就是脚本文件。程序功能越来越多，这些监本文件还可以当做模块导入其他的模块中，实现了重利用。</p>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><p>使用import的时候，想要使用spam下面的方法，必须使用spam.的方式<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> spam</div><div class="line">print(spam.money)</div><div class="line">spam.read1()</div><div class="line">spam.read2()</div><div class="line">spam.change()</div></pre></td></tr></table></figure></p>
<h3 id="from…-import-…"><a href="#from…-import-…" class="headerlink" title="from… import …"></a>from… import …</h3><p>对比import spam，会将源文件的名称空间’spam’带到当前名称空间中，使用时必须是spam.名字的方式<br>而from 语句相当于import，也会创建新的名称空间，但是将spam中的名字直接导入到当前的名称空间中，在当前名称空间中，直接使用名字就可以了、</p>
<h3 id="1-1-使用模块"><a href="#1-1-使用模块" class="headerlink" title="1.1 使用模块"></a>1.1 使用模块</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#spam.py</span></div><div class="line"></div><div class="line">print(<span class="string">'from the spam.py'</span>)</div><div class="line">money=<span class="number">1000</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">read1</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'spam-&gt;read1-&gt;money'</span>,<span class="number">1000</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">read2</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'spam-&gt;read2 calling read'</span>)</div><div class="line">    read1()</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">global</span> money   <span class="comment"># 经过测试这个在执行这个脚本自身的时候，global是把money的值引过来了，然后再下面进行了修改，之后再打印就是0</span></div><div class="line">    money=<span class="number">0</span></div><div class="line">     print(money)  <span class="comment"># 这里是有打印了下 主要 是在模块中的时候进行测试</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line"><span class="comment"># main()</span></div><div class="line">print(<span class="string">"测试"</span>)  <span class="comment"># 初始化执行的</span></div><div class="line">print(money)</div><div class="line">change()</div><div class="line">print(money)</div></pre></td></tr></table></figure>
<p>结果是：<br>1000<br>0<br>0</p>
<h3 id="1-2-Python模块的导入"><a href="#1-2-Python模块的导入" class="headerlink" title="1.2 Python模块的导入"></a>1.2 Python模块的导入</h3><p>python模块在导入的时候，防止重复导入，在第一次导入后，会加载到内存，在之后的调用都是指向内存<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#test.py</span></div><div class="line"><span class="keyword">import</span> spam <span class="comment">#只在第一次导入时才执行spam.py内代码,此处的显式效果是只打印一次'from the spam.py',当然其他的顶级代码也都被执行了,只不过没有显示效果.</span></div><div class="line"><span class="keyword">import</span> spam</div><div class="line"><span class="keyword">import</span> spam</div><div class="line"><span class="keyword">import</span> spam</div><div class="line"><span class="string">'''</span></div><div class="line">执行结果：</div><div class="line">from the spam.py</div><div class="line">'''</div></pre></td></tr></table></figure></p>
<p><strong>从sys.module中找到当前已经加载的模块</strong></p>
<h3 id="1-3-模块的名称空间"><a href="#1-3-模块的名称空间" class="headerlink" title="1.3 模块的名称空间"></a>1.3 模块的名称空间</h3><p><strong>每一个模块都是一个独立的名称空间，</strong>定义在这个模块总的函数会把模块的名称空间当做<strong>全局名称空间</strong>，这样我们在编写自己的模块时，就不用担心我们定义在自己模块中全局变量会在被导入时，与使用者的全局变量冲突</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> spam <span class="keyword">import</span> money, read1, read2,change  <span class="comment"># 可以导入多个</span></div><div class="line">print(money)  <span class="comment"># 引用的是change 中的money</span></div><div class="line">change()  <span class="comment"># 这个是修改了的 只是在</span></div><div class="line">print(money)</div><div class="line"><span class="string">'''</span></div><div class="line">结果是：</div><div class="line">1000</div><div class="line">0</div><div class="line">1000</div><div class="line">'''</div></pre></td></tr></table></figure>
<h3 id="1-4-导入模块的做的事情"><a href="#1-4-导入模块的做的事情" class="headerlink" title="1.4 导入模块的做的事情"></a>1.4 导入模块的做的事情</h3><ol>
<li>为源文件（spam）创建新的名称空间，在spam中定义的函数和方法使用了global时，访问的就是这个名称空间。</li>
<li>在新创建的名称空间中执行模块中包含的代码</li>
<li>创建名字spam来引用该命名空间</li>
</ol>
<p><strong>寻找的优先级：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">'''</span></div><div class="line">先从内存中寻找，sys.modules</div><div class="line">然后从内置的寻找（内建）</div><div class="line">从自己的路径中寻找 从sys.path中寻找</div><div class="line">'''</div></pre></td></tr></table></figure>
<h2 id="2-from-import"><a href="#2-from-import" class="headerlink" title="2 from  import"></a>2 from  import</h2><h3 id="2-1"><a href="#2-1" class="headerlink" title="2.1"></a>2.1</h3><p>python中的变量赋值不是一种存储操作，而只是一种<strong>绑定关系</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> spam <span class="keyword">import</span> money, read1, read2, change</div><div class="line">money = <span class="number">100000000</span>  <span class="comment"># money现在是绑定到新的上</span></div><div class="line">print(money)  <span class="comment"># 现在就有冲突了</span></div><div class="line"></div><div class="line">read1()</div><div class="line">read1 = <span class="number">1111111</span></div><div class="line">read2()  <span class="comment"># 这个不影响，从哪里调用，用哪里的</span></div></pre></td></tr></table></figure>
<h3 id="2-2-from-spam-import"><a href="#2-2-from-spam-import" class="headerlink" title="2.2 from spam import *"></a>2.2 from spam import *</h3><p> from spam import <em> 把spam中所有的不是以下划线(_)开头的名字都导入到当前位置，大部分情况下我们的python程序不应该使用这种导入方式，因为</em>你不知道你导入什么名字，很有可能会覆盖掉你之前已经定义的名字。而且可读性极其的差，在交互式环境中导入时没有问题。</p>
<p><strong>通常使用<strong>all</strong>=[‘money’,’read1’]</strong>,这样引用spam的就只能用money和read1两种</p>
<h2 id="3-把模块当做脚本执行"><a href="#3-把模块当做脚本执行" class="headerlink" title="3 把模块当做脚本执行"></a>3 把模块当做脚本执行</h2><p>文件有两种应用场景，一种是<strong>当做脚本执行</strong>，一种是<strong>当做模块</strong></p>
<h3 id="3-1-脚本执行"><a href="#3-1-脚本执行" class="headerlink" title="3.1 脚本执行"></a>3.1 脚本执行</h3><p>spam文件执行的的时候<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">print(__name__)</div><div class="line">结果是：</div><div class="line"><span class="string">'''</span></div><div class="line">__main__</div><div class="line">'''</div></pre></td></tr></table></figure></p>
<h3 id="3-2-模块执行"><a href="#3-2-模块执行" class="headerlink" title="3.2 模块执行"></a>3.2 模块执行</h3><p>在test文件中导入import spam,打印的结果是<strong>spam</strong></p>
<p><strong>为了能够控制在不同场景下面的转换，使用了if <strong>name</strong> == ‘<strong>main</strong>‘:</strong>，当做脚本执行的时候，逻辑写到if <strong>name</strong> == ‘<strong>main</strong>‘:下面。</p>
<p>当做模块导入的时候，不会执行if <strong>name</strong> == ‘<strong>main</strong>‘:下面的内容。</p>
<h2 id="4-模块搜索路径"><a href="#4-模块搜索路径" class="headerlink" title="4 模块搜索路径"></a>4 模块搜索路径</h2><p>总结模块查找的顺序：</p>
<p><strong>内存–&gt;内建–&gt;sys.path</strong></p>
<p><strong>sys.path 的路径是以执行文件为基准的</strong></p>
<p>在不同的路径中的调用，在dir1中调用dir2中的内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys <span class="comment"># 先导如sys模块</span></div><div class="line">sys.path.append(<span class="string">r"D:\Python_fullstack_s4\day35\模块\dir1"</span>) <span class="comment"># 在sys.path的路径中添加dir1的路径    r是在win平台的转义</span></div><div class="line"><span class="keyword">import</span> spam  <span class="comment"># 添加路径后再调用spam </span></div><div class="line"><span class="string">"""</span></div><div class="line">结果：</div><div class="line">from dir1  # 这是spam中打印的内容</div><div class="line">"""</div></pre></td></tr></table></figure>
<h2 id="5-编译Python文件"><a href="#5-编译Python文件" class="headerlink" title="5 编译Python文件"></a>5 编译Python文件</h2><p>pyc文件是在导入模块的时候进行编译的，提高模块的导入速度，只有import/from import才能产生</p>
<p>提前编译</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m compileall /module_directory 递归着编译</div></pre></td></tr></table></figure>
<h2 id="6-包"><a href="#6-包" class="headerlink" title="6 包"></a>6 包</h2><p>package是有<strong>init</strong>.py  文件的包</p>
<p><strong>包的本质就是一个包含<strong>init</strong>.py文件的目录。</strong></p>
<h3 id="6-1"><a href="#6-1" class="headerlink" title="6.1"></a>6.1</h3><p>创建一个包的目录结构，可以把包想象成一个大的模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">glance/                   <span class="comment">#Top-level package</span></div><div class="line">├── __init__.py      <span class="comment">#Initialize the glance package</span></div><div class="line">├── api                  <span class="comment">#Subpackage for api</span></div><div class="line">│   ├── __init__.py</div><div class="line">│   ├── policy.py</div><div class="line">│   └── versions.py</div><div class="line">├── cmd                <span class="comment">#Subpackage for cmd</span></div><div class="line">│   ├── __init__.py</div><div class="line">│   └── manage.py</div><div class="line">└── db                  <span class="comment">#Subpackage for db</span></div><div class="line">    ├── __init__.py</div><div class="line">    └── models.py</div></pre></td></tr></table></figure>
<p>文件的内容：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#文件内容</span></div><div class="line"><span class="comment">#policy.py</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'from policy.py'</span>)</div><div class="line"><span class="comment">#versions.py</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_resource</span><span class="params">(conf)</span>:</span></div><div class="line">    print(<span class="string">'from version.py: '</span>,conf)</div><div class="line"><span class="comment">#manage.py</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'from manage.py'</span>)</div><div class="line"><span class="comment">#models.py</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">register_models</span><span class="params">(engine)</span>:</span></div><div class="line">    print(<span class="string">'from models.py: '</span>,engine)</div></pre></td></tr></table></figure></p>
<p>想要在外部是用glance-api-policy中的文件</p>
<p><strong>import方法</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> glance.api.plicy   <span class="comment"># 用点的方式</span></div><div class="line">glance.api.plicy.get() <span class="comment"># 通过import导入的还是要用名字的方式进行使用</span></div><div class="line"><span class="string">'''</span></div><div class="line">结果：</div><div class="line">from policy.py   # policy中的get的内容</div><div class="line">'''</div></pre></td></tr></table></figure></p>
<p><strong>from import方法</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> glance.api.plicy <span class="keyword">import</span> get  <span class="comment"># 下面使用的时候就直接使用了</span></div><div class="line">get()</div></pre></td></tr></table></figure></p>
<h3 id="6-2-小结"><a href="#6-2-小结" class="headerlink" title="6.2 小结"></a>6.2 小结</h3><p>在<strong>导入时</strong>都必须遵循一个原则：凡是在<strong>导入时带点的</strong>，点的左边都必须是一个包，<br>对于导入后，在使用时就没有这种限制了，点的左边可以是包,模块，函数，类(它们都可以用点的方式调用自己的属性)。<br>需要注意的是from后import导入的模块，必须是明确的一个不能带点，否则会有语法错误，如：from a import b.c是错误语法</p>
<h3 id="6-3-init-py文件"><a href="#6-3-init-py文件" class="headerlink" title="6.3  init.py文件"></a>6.3  <strong>init</strong>.py文件</h3><p>包都有<strong>init</strong>.py文件，这个文件是包初始化就会执行的文件，可以为空，也可以是初始化的代码<br>导入包的时候，仅仅做的就是执行<strong>init</strong>.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span>  glance.api <span class="keyword">import</span> plicy   <span class="comment"># 导入的是glance  api</span></div><div class="line"><span class="string">'''</span></div><div class="line">结果：</div><div class="line">glance 的包</div><div class="line">init 的包</div><div class="line">'''</div></pre></td></tr></table></figure></p>
<p>下面用import *来测试，也是一样的，但是api下面的内容找不到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> glance.api <span class="keyword">import</span> *   <span class="comment"># 这里则是导入包，执行inti,*对应的是__all__中的</span></div><div class="line"><span class="string">'''</span></div><div class="line">结果：</div><div class="line">glance 的包</div><div class="line">init 的包</div><div class="line">'''</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> glance.api <span class="keyword">import</span> *</div><div class="line">print(x)</div><div class="line">print(y)</div><div class="line"><span class="string">'''</span></div><div class="line">结果：</div><div class="line">glance 的包</div><div class="line">init 的包</div><div class="line">1</div><div class="line">2</div><div class="line">'''</div><div class="line"><span class="string">'''</span></div><div class="line">这是api中__init__,所以*是对应的__all__中的内容</div><div class="line">__all__ = ["x", "y"]</div><div class="line">x = 1</div><div class="line">y = 2</div><div class="line">'''</div></pre></td></tr></table></figure>
<h2 id="7-绝对导入和相对导入"><a href="#7-绝对导入和相对导入" class="headerlink" title="7 绝对导入和相对导入"></a>7 绝对导入和相对导入</h2><h3 id="7-1-绝对导入是从包的最开始的位置开始"><a href="#7-1-绝对导入是从包的最开始的位置开始" class="headerlink" title="7.1 绝对导入是从包的最开始的位置开始"></a>7.1 绝对导入是从包的最开始的位置开始</h3><p>从test的sys.path的列表中寻找<br>绝对导入的缺点是包的名字改变的话有问题</p>
<p>在api的<strong>init</strong>.py下面写<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> glance.api <span class="keyword">import</span> plicy</div><div class="line"><span class="keyword">from</span> glance.api <span class="keyword">import</span> versions</div></pre></td></tr></table></figure></p>
<p>test的使用<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> glance.api  <span class="comment"># 仅仅是导入了glance.api  实际是找不到plicy的，因为导入模块仅仅是执行了__init__</span></div><div class="line">print(glance.api.plicy)</div><div class="line"><span class="string">'''</span></div><div class="line">结果:</div><div class="line">glance 的包</div><div class="line">init 的包</div><div class="line">&lt;module 'glance.api.plicy' from 'D:\\Python_fullstack_s4\\day35\\包\\glance\\api\\plicy.py'&gt;</div><div class="line">'''</div></pre></td></tr></table></figure></p>
<h3 id="7-2-相对导入"><a href="#7-2-相对导入" class="headerlink" title="7.2 相对导入"></a>7.2 相对导入</h3><p>.–当前目录<br>..–上一级的目录<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> . <span class="keyword">import</span> plicy,versions  <span class="comment">#  通过当前目录的方式导入，当前的目录是api</span></div></pre></td></tr></table></figure></p>
<p>注意这种方式的<strong>init</strong>自己执行的时候会报错</p>
<p>导入包的执行效果<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> glance.api</div><div class="line">print(glance.api.plicy.get())</div><div class="line">print(glance.api.versions.create_resource(<span class="string">'aaa'</span>))</div><div class="line"><span class="string">'''</span></div><div class="line">结果：</div><div class="line">from . import plicy,versionsglance 的包</div><div class="line">init 的包</div><div class="line">from policy.py</div><div class="line">None</div><div class="line">from version.py:  aaa</div><div class="line">None</div><div class="line">'''</div></pre></td></tr></table></figure></p>
<h2 id="8-通过包调用内部的所有的"><a href="#8-通过包调用内部的所有的" class="headerlink" title="8 通过包调用内部的所有的"></a>8 通过包调用内部的所有的</h2><p>这是glance的包中的<strong>init</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> .api.plicy <span class="keyword">import</span> get   <span class="comment"># 都是用的相对导入</span></div><div class="line"><span class="keyword">from</span> .api.versions <span class="keyword">import</span> create_resource</div><div class="line"><span class="keyword">from</span> .cmd.manage <span class="keyword">import</span> main</div><div class="line"><span class="keyword">from</span> .db.modules <span class="keyword">import</span> register_models</div></pre></td></tr></table></figure></p>
<p>包的定义者容易管理，对于使用者来说，使用的不知道是包还是模块</p>
<p>test文件调用的方式<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> glance</div><div class="line"></div><div class="line">glance.get()  <span class="comment"># 直接就能够使用</span></div><div class="line"><span class="string">'''</span></div><div class="line">glance 的包</div><div class="line">init 的包</div><div class="line">cmd 的包</div><div class="line">from policy.py</div><div class="line">'''</div></pre></td></tr></table></figure></p>
<h3 id="8-包遵循的原则"><a href="#8-包遵循的原则" class="headerlink" title="8 包遵循的原则"></a>8 包遵循的原则</h3><p><strong>特别需要注意的是：可以用import导入内置或者第三方模块，但是要绝对避免使用import来导入自定义包的子模块，应该使用from… import …的绝对或者相对导入,且==包的相对导入只能用from的形式。==</strong></p>
<p>包是给别人用的，<strong>是不能自己运行的</strong>。自己运行的时候会出错</p>
<h2 id="9-在任意位置都能调用包"><a href="#9-在任意位置都能调用包" class="headerlink" title="9 在任意位置都能调用包"></a>9 在任意位置都能调用包</h2><p>关键是在运行的的文件查找到的是当前目录的sys.path,如果在别的目录中使用的话就需要找到包的父目录</p>
<p>首先找到文件的绝对路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line"></div><div class="line">p=os.path.abspath(__file__)  <span class="comment"># 打印的是文件的绝对路径</span></div><div class="line">print(p)</div><div class="line"><span class="string">'''</span></div><div class="line">结果：</div><div class="line">D:\Python_fullstack_s4\day35\包\test.py</div><div class="line">'''</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">p = os.path.dirname(os.path.abspath(__file__)) <span class="comment"># 返回的是文件的上一级目录</span></div><div class="line">print(p)</div><div class="line"><span class="string">'''</span></div><div class="line">结果：</div><div class="line">D:\Python_fullstack_s4\day35\包</div><div class="line">'''</div></pre></td></tr></table></figure>
<p><strong>下面的目录结构是</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">D:.day35</div><div class="line">├─包</div><div class="line">│  └─glance</div><div class="line">│      ├─api</div><div class="line">│      │  └─__pycache__</div><div class="line">│      ├─cmd</div><div class="line">│      │  └─__pycache__</div><div class="line">│      ├─db</div><div class="line">│      │  └─__pycache__</div><div class="line">│      └─__pycache__</div><div class="line">├─模块</div><div class="line">│  ├─dir1</div><div class="line">│  │  └─__pycache__</div><div class="line">│  ├─dir2</div><div class="line">│  └─__pycache__</div><div class="line">└─练习</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line"></div><div class="line">base_path = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</div><div class="line"><span class="comment"># sys.path.append(r"%s"%(base_path)) # 把父目录添加到sys.path中</span></div><div class="line">sys.path.append(<span class="string">r'%s\包'</span> %(base_path))  <span class="comment"># 拼接路径,这里拼接的是有glance的包</span></div><div class="line">print(base_path)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> glance</div><div class="line">glance.get()</div><div class="line"><span class="string">'''</span></div><div class="line"></div><div class="line">结果：</div><div class="line">D:\Python_fullstack_s4\day35</div><div class="line">glance 的包</div><div class="line">init 的包</div><div class="line">cmd 的包</div><div class="line">'''</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li></ul>

      
        
	<div id="comment">
	
	<!-- 多说评论框 start -->
	 <div class="ds-thread" data-thread-key="/2017/05/02/Python模块调用/" data-title="Python模块调用" data-url="https://github.com/ythzx/ythzx.github.io/2017/05/02/Python模块调用/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"ythzx"};
	  (function() {
	    var ds = document.createElement('script');
	    ds.type = 'text/javascript';ds.async = true;
	    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	    ds.charset = 'UTF-8';
	    (document.getElementsByTagName('head')[0] 
	     || document.getElementsByTagName('body')[0]).appendChild(ds);
	  })();
	  </script>
	<!-- 多说公共JS代码 end -->
	
	</div>
	<link rel="stylesheet" href="/css/comment.css">


      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/05/03/Python socket网络编程/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">
        
          Python socket网络编程
        
      </div>
    </a>
  
  
    <a href="/2017/05/02/Python错误和异常/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">Python 错误和异常</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
      <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-模块"><span class="nav-number">1.</span> <span class="nav-text">1 模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#import"><span class="nav-number">1.1.</span> <span class="nav-text">import</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#from…-import-…"><span class="nav-number">1.2.</span> <span class="nav-text">from… import …</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-使用模块"><span class="nav-number">1.3.</span> <span class="nav-text">1.1 使用模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Python模块的导入"><span class="nav-number">1.4.</span> <span class="nav-text">1.2 Python模块的导入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-模块的名称空间"><span class="nav-number">1.5.</span> <span class="nav-text">1.3 模块的名称空间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-导入模块的做的事情"><span class="nav-number">1.6.</span> <span class="nav-text">1.4 导入模块的做的事情</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-from-import"><span class="nav-number">2.</span> <span class="nav-text">2 from  import</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1"><span class="nav-number">2.1.</span> <span class="nav-text">2.1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-from-spam-import"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 from spam import *</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-把模块当做脚本执行"><span class="nav-number">3.</span> <span class="nav-text">3 把模块当做脚本执行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-脚本执行"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 脚本执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-模块执行"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 模块执行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-模块搜索路径"><span class="nav-number">4.</span> <span class="nav-text">4 模块搜索路径</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-编译Python文件"><span class="nav-number">5.</span> <span class="nav-text">5 编译Python文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-包"><span class="nav-number">6.</span> <span class="nav-text">6 包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1"><span class="nav-number">6.1.</span> <span class="nav-text">6.1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-小结"><span class="nav-number">6.2.</span> <span class="nav-text">6.2 小结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-init-py文件"><span class="nav-number">6.3.</span> <span class="nav-text">6.3  init.py文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-绝对导入和相对导入"><span class="nav-number">7.</span> <span class="nav-text">7 绝对导入和相对导入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-绝对导入是从包的最开始的位置开始"><span class="nav-number">7.1.</span> <span class="nav-text">7.1 绝对导入是从包的最开始的位置开始</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-相对导入"><span class="nav-number">7.2.</span> <span class="nav-text">7.2 相对导入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-通过包调用内部的所有的"><span class="nav-number">8.</span> <span class="nav-text">8 通过包调用内部的所有的</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-包遵循的原则"><span class="nav-number">8.1.</span> <span class="nav-text">8 包遵循的原则</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-在任意位置都能调用包"><span class="nav-number">9.</span> <span class="nav-text">9 在任意位置都能调用包</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
          <script type="text/javascript" src="//ra.revolvermaps.com/0/0/6.js?i=0ffcolhjeyf&amp;m=7&amp;c=e63100&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=90&amp;lx=-420&amp;ly=420&amp;hi=20&amp;he=7&amp;hc=a8ddff&amp;rs=80" async="async"></script>
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2018 Peter&#39;s Blog Center All Rights Reserved.
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>






<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?93b40df12317201527431272f20ac28a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
  

  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>


  <script type="text/javascript" color="33,33,33" zindex="-1" opacity="1" count="80" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
