<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Peter&#39;s Blog Center</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="Peter's Blog Center">
<meta property="og:url" content="https://github.com/ythzx/ythzx.github.io/index.html">
<meta property="og:site_name" content="Peter's Blog Center">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Peter's Blog Center">
  
    <link rel="alternate" href="/atom.xml" title="Peter&#39;s Blog Center" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/hiero.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >

</head>



  <body>


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="Peter&#39;s Blog Center" rel="home"> Peter&#39;s Blog Center </a>
            
          </h1>

          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">首页</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">归档</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">分类</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">标签</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">关于</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>




  <div id="container" style='background: rgba(255,255,255,0.5);'>
    <div id="wrap" style='background: rgba(255,255,255,0.5);'>
            
      <div id="content" class="outer" style='background: rgba(255,255,255,0.5);'>
        
          <section id="main">
  
    <article id="post-多表操作"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/07/10/多表操作/">Django models多表操作</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/07/10/多表操作/" class="article-date">
	  <time datetime="2017-07-10T11:09:36.233Z" itemprop="datePublished">七月 10, 2017</time>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        

          
            <div class="entry-summary" style="margin-left:0;">
            Django models多表操作单独创建第三张表的情况
推荐使用的是使用values/value_list,selet_related的方式，查询效率高
建立表1234567891011class Boy(models.Model):    name = models.CharField(max_length=32)class Girl(models.Model):    nick = models.CharField(max_length=32)class Love(models.Model):    b = models.ForeignKey('Boy')    g = models.ForeignKey('Girl')
表建立联合唯一索引unique_together12345...
          

        
          <p class="article-more-link">
            <a href="/2017/07/10/多表操作/#more">阅读全文</a>
          </p>
        </div>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Django/">Django</a></li></ul>

      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-博客项目文档"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/07/10/博客项目文档/">Django博客项目</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/07/10/博客项目文档/" class="article-date">
	  <time datetime="2017-07-10T08:53:47.092Z" itemprop="datePublished">七月 10, 2017</time>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Django博客项目"><a href="#Django博客项目" class="headerlink" title="Django博客项目"></a>Django博客项目</h1><h2 id="配置静态文件"><a href="#配置静态文件" class="headerlink" title="配置静态文件"></a>配置静态文件</h2><p>setting中添加<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">STATICFILES_DIRS =(</div><div class="line">    os.path.join(BASE_DIR,<span class="string">'static'</span>),</div><div class="line">)</div></pre></td></tr></table></figure></p>
<h2 id="数据库MySQL"><a href="#数据库MySQL" class="headerlink" title="数据库MySQL"></a>数据库MySQL</h2><h3 id="配置setting"><a href="#配置setting" class="headerlink" title="配置setting"></a>配置setting</h3><p>前提是新建数据库blog<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">DATABASES = &#123;</div><div class="line">    <span class="string">'default'</span>: &#123;</div><div class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</div><div class="line">        <span class="string">'NAME'</span>: <span class="string">'blog'</span>,</div><div class="line">        <span class="string">'USER'</span>: <span class="string">'root'</span>,</div><div class="line">        <span class="string">'PASSWORD'</span>: <span class="string">'871577942@mysql'</span>,</div><div class="line">        <span class="string">'HOST'</span>: <span class="string">'localhost'</span>,</div><div class="line">        <span class="string">'PORT'</span>: <span class="number">3306</span>,</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="配置成pymysql进行连接及MySQL"><a href="#配置成pymysql进行连接及MySQL" class="headerlink" title="配置成pymysql进行连接及MySQL"></a>配置成pymysql进行连接及MySQL</h3><p>在app01中的的<strong>init</strong>中<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pymysql</div><div class="line">pymysql.install_as_MySQLdb()</div></pre></td></tr></table></figure></p>
<h2 id="models-设计表的结构"><a href="#models-设计表的结构" class="headerlink" title="models 设计表的结构"></a>models 设计表的结构</h2><h3 id="在modles中创建"><a href="#在modles中创建" class="headerlink" title="在modles中创建"></a>在modles中创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    用户表</div><div class="line">    """</div><div class="line">    nid = models.BigAutoField(primary_key=<span class="keyword">True</span>)</div><div class="line">    username = models.CharField(verbose_name=<span class="string">'用户名'</span>, max_length=<span class="number">32</span>, unique=<span class="keyword">True</span>)</div><div class="line">    password = models.CharField(verbose_name=<span class="string">'密码'</span>, max_length=<span class="number">64</span>)</div><div class="line">    nickname = models.CharField(verbose_name=<span class="string">'昵称'</span>, max_length=<span class="number">32</span>)</div><div class="line">    email = models.EmailField(verbose_name=<span class="string">'邮箱'</span>, unique=<span class="keyword">True</span>)</div><div class="line">    avatar = models.ImageField(verbose_name=<span class="string">'头像'</span>)</div><div class="line"></div><div class="line">    create_time = models.DateTimeField(verbose_name=<span class="string">'创建时间'</span>, auto_now_add=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">    fans = models.ManyToManyField(verbose_name=<span class="string">'粉丝们'</span>,</div><div class="line">                                  to=<span class="string">'UserInfo'</span>,</div><div class="line">                                  through=<span class="string">'UserFans'</span>,</div><div class="line">                                  related_name=<span class="string">'f'</span>,</div><div class="line">                                  through_fields=(<span class="string">'user'</span>, <span class="string">'follower'</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Blog</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    博客信息</div><div class="line">    """</div><div class="line">    nid = models.BigAutoField(primary_key=<span class="keyword">True</span>)</div><div class="line">    title = models.CharField(verbose_name=<span class="string">'个人博客标题'</span>, max_length=<span class="number">64</span>)</div><div class="line">    site = models.CharField(verbose_name=<span class="string">'个人博客前缀'</span>, max_length=<span class="number">32</span>, unique=<span class="keyword">True</span>)</div><div class="line">    theme = models.CharField(verbose_name=<span class="string">'博客主题'</span>, max_length=<span class="number">32</span>)</div><div class="line">    user = models.OneToOneField(to=<span class="string">'UserInfo'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserFans</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    互粉关系表</div><div class="line">    """</div><div class="line">    user = models.ForeignKey(verbose_name=<span class="string">'博主'</span>, to=<span class="string">'UserInfo'</span>, to_field=<span class="string">'nid'</span>, related_name=<span class="string">'users'</span>)</div><div class="line">    follower = models.ForeignKey(verbose_name=<span class="string">'粉丝'</span>, to=<span class="string">'UserInfo'</span>, to_field=<span class="string">'nid'</span>, related_name=<span class="string">'followers'</span>)</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></div><div class="line">        unique_together = [</div><div class="line">            (<span class="string">'user'</span>, <span class="string">'follower'</span>),</div><div class="line">        ]</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Category</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    博主个人文章分类表</div><div class="line">    """</div><div class="line">    nid = models.AutoField(primary_key=<span class="keyword">True</span>)</div><div class="line">    title = models.CharField(verbose_name=<span class="string">'分类标题'</span>, max_length=<span class="number">32</span>)</div><div class="line"></div><div class="line">    blog = models.ForeignKey(verbose_name=<span class="string">'所属博客'</span>, to=<span class="string">'Blog'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArticleDetail</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    文章详细表</div><div class="line">    """</div><div class="line">    content = models.TextField(verbose_name=<span class="string">'文章内容'</span>, )</div><div class="line"></div><div class="line">    article = models.OneToOneField(verbose_name=<span class="string">'所属文章'</span>, to=<span class="string">'Article'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UpDown</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    文章顶或踩</div><div class="line">    """</div><div class="line">    article = models.ForeignKey(verbose_name=<span class="string">'文章'</span>, to=<span class="string">'Article'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line">    user = models.ForeignKey(verbose_name=<span class="string">'赞或踩用户'</span>, to=<span class="string">'UserInfo'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line">    up = models.BooleanField(verbose_name=<span class="string">'是否赞'</span>)</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></div><div class="line">        unique_together = [</div><div class="line">            (<span class="string">'article'</span>, <span class="string">'user'</span>),</div><div class="line">        ]</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Comment</span><span class="params">(models.Model)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    评论表</div><div class="line">    """</div><div class="line">    nid = models.BigAutoField(primary_key=<span class="keyword">True</span>)</div><div class="line">    content = models.CharField(verbose_name=<span class="string">'评论内容'</span>, max_length=<span class="number">255</span>)</div><div class="line">    create_time = models.DateTimeField(verbose_name=<span class="string">'创建时间'</span>, auto_now_add=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">    reply = models.ForeignKey(verbose_name=<span class="string">'回复评论'</span>, to=<span class="string">'self'</span>, related_name=<span class="string">'back'</span>, null=<span class="keyword">True</span>)</div><div class="line">    article = models.ForeignKey(verbose_name=<span class="string">'评论文章'</span>, to=<span class="string">'Article'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line">    user = models.ForeignKey(verbose_name=<span class="string">'评论者'</span>, to=<span class="string">'UserInfo'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tag</span><span class="params">(models.Model)</span>:</span></div><div class="line">    nid = models.AutoField(primary_key=<span class="keyword">True</span>)</div><div class="line">    title = models.CharField(verbose_name=<span class="string">'标签名称'</span>, max_length=<span class="number">32</span>)</div><div class="line">    blog = models.ForeignKey(verbose_name=<span class="string">'所属博客'</span>, to=<span class="string">'Blog'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article</span><span class="params">(models.Model)</span>:</span></div><div class="line">    nid = models.BigAutoField(primary_key=<span class="keyword">True</span>)</div><div class="line">    title = models.CharField(verbose_name=<span class="string">'文章标题'</span>, max_length=<span class="number">128</span>)</div><div class="line">    summary = models.CharField(verbose_name=<span class="string">'文章简介'</span>, max_length=<span class="number">255</span>)</div><div class="line">    read_count = models.IntegerField(default=<span class="number">0</span>)</div><div class="line">    comment_count = models.IntegerField(default=<span class="number">0</span>)</div><div class="line">    up_count = models.IntegerField(default=<span class="number">0</span>)</div><div class="line">    down_count = models.IntegerField(default=<span class="number">0</span>)</div><div class="line">    create_time = models.DateTimeField(verbose_name=<span class="string">'创建时间'</span>, auto_now_add=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">    blog = models.ForeignKey(verbose_name=<span class="string">'所属博客'</span>, to=<span class="string">'Blog'</span>, to_field=<span class="string">'nid'</span>)</div><div class="line">    category = models.ForeignKey(verbose_name=<span class="string">'文章类型'</span>, to=<span class="string">'Category'</span>, to_field=<span class="string">'nid'</span>, null=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">    type_choices = [</div><div class="line">        (<span class="number">1</span>, <span class="string">"Python"</span>),</div><div class="line">        (<span class="number">2</span>, <span class="string">"Linux"</span>),</div><div class="line">        (<span class="number">3</span>, <span class="string">"OpenStack"</span>),</div><div class="line">        (<span class="number">4</span>, <span class="string">"GoLang"</span>),</div><div class="line">    ]</div><div class="line"></div><div class="line">    article_type_id = models.IntegerField(choices=type_choices, default=<span class="keyword">None</span>)</div><div class="line"></div><div class="line">    tags = models.ManyToManyField(</div><div class="line">        to=<span class="string">"Tag"</span>,</div><div class="line">        through=<span class="string">'Article2Tag'</span>,</div><div class="line">        through_fields=(<span class="string">'article'</span>, <span class="string">'tag'</span>),</div><div class="line">    )</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Article2Tag</span><span class="params">(models.Model)</span>:</span></div><div class="line">    article = models.ForeignKey(verbose_name=<span class="string">'文章'</span>, to=<span class="string">"Article"</span>, to_field=<span class="string">'nid'</span>)</div><div class="line">    tag = models.ForeignKey(verbose_name=<span class="string">'标签'</span>, to=<span class="string">"Tag"</span>, to_field=<span class="string">'nid'</span>)</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Meta</span>:</span></div><div class="line">        unique_together = [</div><div class="line">            (<span class="string">'article'</span>, <span class="string">'tag'</span>),</div><div class="line">        ]</div></pre></td></tr></table></figure>
<h3 id="生成表"><a href="#生成表" class="headerlink" title="生成表"></a>生成表</h3><ol>
<li><p>需要pip install pillow ,是ImageField需要</p>
</li>
<li><p>python3 manage.py makemigratons</p>
</li>
<li><p>python3 manage.py migrate</p>
</li>
</ol>
<h2 id="页面"><a href="#页面" class="headerlink" title="页面"></a>页面</h2><h3 id="1-导航条"><a href="#1-导航条" class="headerlink" title="1 导航条"></a>1 导航条</h3><p>使用 Bootstrap的导航条</p>
<h4 id="修改导航条两侧间距"><a href="#修改导航条两侧间距" class="headerlink" title="修改导航条两侧间距"></a>修改导航条两侧间距</h4><p>把<code>&quot;container-fluid&quot;</code>修改成container</p>
<p>内部实现的原理就是设置一个宽度，<code>margin 0，auto</code></p>
<h4 id="修改Bootstrap的整体圆角"><a href="#修改Bootstrap的整体圆角" class="headerlink" title="修改Bootstrap的整体圆角"></a>修改Bootstrap的整体圆角</h4><p>自己写css并导入,使用<code>!important</code>设置优先级</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.no-radius</span>&#123;</div><div class="line">    <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="meta">!important</span>;<span class="comment">/*强制覆盖Bootstrap的样式*/</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="修改导航条的分类"><a href="#修改导航条的分类" class="headerlink" title="修改导航条的分类"></a>修改导航条的分类</h4><p>文章表中有type_choices 的数据，是类中的数据，然后发送到前端<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">type_choices = [</div><div class="line">       (<span class="number">1</span>, <span class="string">"Python"</span>),</div><div class="line">       (<span class="number">2</span>, <span class="string">"Linux"</span>),</div><div class="line">       (<span class="number">3</span>, <span class="string">"OpenStack"</span>),</div><div class="line">       (<span class="number">4</span>, <span class="string">"GoLang"</span>),</div><div class="line">   ]</div></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">type_choice_list = models.Article.type_choices  <span class="comment"># 直接从类中找的</span></div></pre></td></tr></table></figure>
<h3 id="2-下部文章用栅格分开"><a href="#2-下部文章用栅格分开" class="headerlink" title="2 下部文章用栅格分开"></a>2 下部文章用栅格分开</h3><p><a href="http://v3.bootcss.com/css/#grid" target="_blank" rel="external">http://v3.bootcss.com/css/#grid</a></p>
<p>在外侧的div设置<code>container</code> 和上面的保持一致</p>
<p>进行左右分割<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">class=&quot;col-md-8&quot;</div><div class="line">class=&quot;col-md-4&quot;</div></pre></td></tr></table></figure></p>
<h4 id="2-1-左侧内容"><a href="#2-1-左侧内容" class="headerlink" title="2.1 左侧内容"></a>2.1 左侧内容</h4><p>因为a标签占据一整行，图片的设置成浮动left，之后用clearfix清除，相当于clearboth</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"art-body clearfix"</span>&gt;</span>&#123;# clearfix 清除浮动 #&#125;</div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/static/images/1.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	近期一个项目需要用到低功耗蓝牙的开发，由于之前没有蓝牙开发的经验，发现网上关于蓝牙开发的资料不多，不是随便描述一下就是已经过时的，在此整理一篇低功耗蓝牙的入门资料，能够完成使用蓝牙的接受和发送数据。 低功耗蓝牙 (BLE，</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h5 id="从后台数据查询文章表的信息，然后传递给后台"><a href="#从后台数据查询文章表的信息，然后传递给后台" class="headerlink" title="从后台数据查询文章表的信息，然后传递给后台"></a>从后台数据查询文章表的信息，然后传递给后台</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    <span class="comment"># type_choices_list = models.Article.objects.type_choice  # 这是错误的 这是从数据库中找</span></div><div class="line">    type_choice_list = models.Article.type_choices  <span class="comment"># 直接从类中找的</span></div><div class="line">    articel_list = models.Article.objects.all()</div><div class="line">    <span class="keyword">return</span> render(</div><div class="line">        request,</div><div class="line">        <span class="string">'index.html'</span>,</div><div class="line">        &#123;</div><div class="line">            <span class="string">'type_choice_list'</span>:type_choice_list,</div><div class="line">            <span class="string">'articel_list'</span>:articel_list,</div><div class="line">        &#125;</div><div class="line">    )</div></pre></td></tr></table></figure>
<p><strong>前端:</strong></p>
<p>在前端页面用for循环进行展示页面，文章表中有的直接从文章表中查找</p>
<p><strong>头像</strong>通过blog与用户关联，BLog表与Userinfo是OneToOne关系，直接点出avatar。</p>
<p>img 的src是<code>src=&quot;&quot;</code>.关键是数据库中存储的是图片的路径，是一个字符串，<code>/static/images/1.jpg</code></p>
<p>下面是userinfo表中的avatar字段，存储的是头像的路径。<br><img src="http://images2015.cnblogs.com/blog/658994/201707/658994-20170711160152556-1014780662.jpg" alt=""></p>
<ul>
<li>发布时间设置成固定的格式<code>articel.create_time|date:&#39;Y-m-d&#39;</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&#123;% for articel in articel_list %&#125;</div><div class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"article-list"</span> <span class="attr">style</span>=<span class="string">"padding: 20px"</span>&gt;</span></div><div class="line">           &#123;# 文章的内容 标题 简介 头像 #&#125;</div><div class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"article-item"</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"art-head"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span>&#123;&#123; articel.title &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"art-body clearfix"</span> &gt;</span>&#123;# clearfix 清除浮动 #&#125;</div><div class="line">                   <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; articel.blog.user.avatar &#125;&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                   &#123;&#123; articel.summary &#125;&#125;</div><div class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">               &#123;# 文章的作者信息 发布时间 点赞 #&#125;</div><div class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"art-foot"</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></div><div class="line">                       <span class="tag">&lt;<span class="name">span</span>  <span class="attr">class</span>=<span class="string">"fa fa-user-circle"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                       作者:&#123;&#123; articel.blog.user.username &#125;&#125;</div><div class="line">                   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></div><div class="line">                       <span class="tag">&lt;<span class="name">span</span>&gt;</span>发布时间:&#123;&#123; articel.create_time|date:'Y-m-d' &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></div><div class="line">                       <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fa fa-commenting"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>评论(&#123;&#123; articel.comment_count &#125;&#125;)<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></div><div class="line">                       <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"fa fa-thumbs-up"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>赞(&#123;&#123; articel.up_count &#125;&#125;)<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span>&gt;</span></div><div class="line">                       <span class="tag">&lt;<span class="name">span</span>  <span class="attr">class</span>=<span class="string">"fa fa-book"</span> <span class="attr">aria-hidden</span>=<span class="string">"true"</span>&gt;</span>阅读(&#123;&#123; articel.read_count &#125;&#125;)<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">       &#123;% endfor %&#125;</div></pre></td></tr></table></figure>
<h5 id="对文章内容进行筛选"><a href="#对文章内容进行筛选" class="headerlink" title="对文章内容进行筛选"></a>对文章内容进行筛选</h5><p>文章内容的筛选是通过跳转不同的URL进行的，有一个all，<strong>all和主页兼容</strong>。其他的是Python、Linux、go..</p>
<p><strong>1 ULR设置</strong></p>
<p>下面的情况是访问all/1的时候和index的是一样的<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</div><div class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</div><div class="line"><span class="keyword">from</span> app01 <span class="keyword">import</span> views</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</div><div class="line">    url(<span class="string">r'^all/(\d+)'</span>, views.index),  <span class="comment"># 这里修改成带参数的</span></div><div class="line">    url(<span class="string">r'^index/'</span>, views.index),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>后台要兼容两种情况，使用<em>args，*</em>kwargs进行接收<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request,*args,**kwargs)</span>:</span></div></pre></td></tr></table></figure></p>
<p><strong>2 URL进一步修改</strong></p>
<p>使用<code>?P&lt;type_id&gt;</code>是传具体的值到后台，后台用**kwargs进行接收</p>
<p>**kwargs不一定有，访问index的时候为空，访问all/1的时候获取的是type_id的值，通过type_id的值可以对文章类型进行过滤。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^admin/'</span>, admin.site.urls),</div><div class="line">    url(<span class="string">r'^all/(?P&lt;type_id&gt;\d+)'</span>, views.index), <span class="comment"># 按关键字传值</span></div><div class="line">    url(<span class="string">r'^'</span>, views.index),  <span class="comment"># 默认直接访问主站</span></div><div class="line">]</div></pre></td></tr></table></figure>
<p><strong>3 对文章进行筛选</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request,*args,**kwargs)</span>:</span></div><div class="line">    <span class="comment"># type_choices_list = models.Article.objects.type_choice  # 这是错误的 这是从数据库中找</span></div><div class="line">    type_choice_list = models.Article.type_choices  <span class="comment"># 直接从类中找的</span></div><div class="line">    type_id = int(kwargs.get(<span class="string">'type_id'</span>)) <span class="keyword">if</span> kwargs.get(<span class="string">'type_id'</span>) <span class="keyword">else</span> <span class="keyword">None</span>  <span class="comment"># 如果kwargs中获取到文类型id 则转换成int,否则返回None</span></div><div class="line">    <span class="keyword">if</span> type_id:</div><div class="line">        articel_list = models.Article.objects.filter(article_type_id=type_id)  <span class="comment"># 如果是all/1的情况 显示过滤的文章类型</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        articel_list = models.Article.objects.all()  <span class="comment"># 访问主页的情况，查询所有的数据</span></div><div class="line">    <span class="keyword">return</span> render(</div><div class="line">        request,</div><div class="line">        <span class="string">'index.html'</span>,</div><div class="line">        &#123;</div><div class="line">            <span class="string">'type_choice_list'</span>:type_choice_list,</div><div class="line">            <span class="string">'articel_list'</span>:articel_list,</div><div class="line">        &#125;</div><div class="line">    )</div></pre></td></tr></table></figure>
<p><strong>4修改切换的URL</strong></p>
<p>全部的时候用<code>/</code>代表主页，用all/ 拼接路径，拼成all/1,all/2</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></div><div class="line">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">          &#123;% for item in type_choice_list %&#125;</div><div class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/all/&#123;&#123; item.0 &#125;&#125;/"</span>&gt;</span>&#123;&#123; item.1 &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">          &#123;% endfor %&#125;</div><div class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>5 切换的时候激活</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"nav navbar-nav"</span>&gt;</span></div><div class="line">         &#123;% if type_id %&#125;</div><div class="line">             <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">         &#123;% else %&#125;</div><div class="line">             <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>全部<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">         &#123;% endif %&#125;</div><div class="line">         &#123;% for item in type_choice_list %&#125;</div><div class="line">             &#123;% if item.0 == type_id %&#125;</div><div class="line">                 <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/all/&#123;&#123; item.0 &#125;&#125;/"</span>&gt;</span>&#123;&#123; item.1 &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">             &#123;% else %&#125;</div><div class="line">               <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/all/&#123;&#123; item.0 &#125;&#125;/"</span>&gt;</span>&#123;&#123; item.1 &#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">              &#123;% endif %&#125;</div><div class="line">         &#123;% endfor %&#125;</div></pre></td></tr></table></figure>
<h4 id="2-2-右侧内容"><a href="#2-2-右侧内容" class="headerlink" title="2.2 右侧内容"></a>2.2 右侧内容</h4><p>在右侧添加面板</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4"</span>&gt;</span></div><div class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span> 最新<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span> 最热<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="登录界面"><a href="#登录界面" class="headerlink" title="登录界面"></a>登录界面</h3><p>注意设置URL的时候，login放在index的前面，index放在最后。路由是从上往下找。<br>设置name属性</p>
<h4 id="验证功能"><a href="#验证功能" class="headerlink" title="验证功能"></a>验证功能</h4><p>验证码的宽度调节<code>class=&quot;col-sm-5&quot;</code>，左右设置成5</p>
<p><strong>1 通过URL获取获取图片</strong></p>
<p>img的src属性设置成一个路径，如果设置成一个静态路径，Django内部自动把图片显示。<br>下面是通过函数的形式，返回值是图片</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-5"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">"width: 120px;height: 30px;"</span> <span class="attr">src</span>=<span class="string">"/check_code/"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>对应URL：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">url(<span class="string">r'^check_code/'</span>, views.check_code),</div></pre></td></tr></table></figure></p>
<p>读取文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_code</span><span class="params">(request)</span>:</span></div><div class="line">    f = open(<span class="string">'static/images/1.jpg'</span>, <span class="string">'rb'</span>)  <span class="comment"># 使用rb模式读取</span></div><div class="line">    data = f.read()</div><div class="line">    f.close()</div><div class="line">    <span class="keyword">return</span> HttpResponse(data)  <span class="comment"># 返回后能直接解析</span></div></pre></td></tr></table></figure>
<p><strong>2 使用pillow自己创建文件</strong></p>
<ul>
<li>创建一个文件句柄，用于保存图片文件</li>
<li>创建一个图片对象</li>
<li>都是字节的形式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</div><div class="line">f = open(<span class="string">'code.png'</span>, <span class="string">'wb'</span>)  <span class="comment"># 创建一个文件句柄，用于保存图片文件</span></div><div class="line">img = Image.new(mode=<span class="string">'RGB'</span>, size=(<span class="number">120</span>, <span class="number">30</span>), color=(<span class="number">123</span>, <span class="number">255</span>, <span class="number">255</span>))  <span class="comment"># 创建一个图片对象</span></div><div class="line">img.save(f, <span class="string">'png'</span>)  <span class="comment"># 第一个是文件句柄 第二个是format</span></div><div class="line">f.close()</div><div class="line">f = open(<span class="string">'code.png'</span>, <span class="string">'rb'</span>)  <span class="comment"># 使用rb模式读取</span></div><div class="line">data = f.read()</div><div class="line">f.close()</div><div class="line"><span class="keyword">return</span> HttpResponse(data)</div></pre></td></tr></table></figure>
<p><strong>3 从内存中读取 BytesIO模块</strong></p>
<p>上面的方式是：<code>创建图片-&gt;内存-&gt;硬盘-&gt;内存</code>，最好的方式是直接从内存中获取。</p>
<p>Python的BytesIO模块在内存中开辟一块空间</p>
<ul>
<li>创建BytesIO对象</li>
<li>在内存中保存的格式</li>
<li>从内存中获取数据getvalue</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</div><div class="line">   <span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</div><div class="line">   f = BytesIO()</div><div class="line">   img = Image.new(mode=<span class="string">'RGB'</span>, size=(<span class="number">120</span>, <span class="number">30</span>), color=(<span class="number">123</span>, <span class="number">255</span>, <span class="number">255</span>))  <span class="comment"># 创建一个图片对象</span></div><div class="line">   img.save(f,<span class="string">'png'</span>)</div><div class="line">   data = f.getvalue()  <span class="comment"># 从内存中获取数据</span></div><div class="line"></div><div class="line">   <span class="keyword">return</span> HttpResponse(data)</div></pre></td></tr></table></figure>
<p><strong>4 创建白板 画笔对象</strong></p>
<h5 id="画点"><a href="#画点" class="headerlink" title="画点"></a>画点</h5><ul>
<li>ImageDraw</li>
<li>ImageDraw.Draw(img,’RGB’)</li>
<li>draw.point([10,10],fill=’red’)  # 坐标 颜色</li>
<li>draw.point([30,10],fill=(255,255,255)) # 颜色的两种表示形式</li>
<li>随机颜色 random</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image,ImageDraw</div><div class="line">   <span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</div><div class="line">   f = BytesIO()</div><div class="line">   img = Image.new(mode=<span class="string">'RGB'</span>, size=(<span class="number">120</span>, <span class="number">30</span>), color=(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))  <span class="comment"># 创建一个图片对象</span></div><div class="line">   draw = ImageDraw.Draw(img,<span class="string">'RGB'</span>)</div><div class="line">   draw.point([<span class="number">10</span>,<span class="number">10</span>],fill=<span class="string">'red'</span>)</div><div class="line">   draw.point([<span class="number">20</span>,<span class="number">10</span>],fill=<span class="string">'red'</span>)</div><div class="line">   draw.point([<span class="number">30</span>,<span class="number">10</span>],fill=(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</div><div class="line">   img.save(f,<span class="string">'png'</span>)</div><div class="line">   data = f.getvalue()  <span class="comment"># 从内存中获取数据</span></div><div class="line"></div><div class="line">   <span class="keyword">return</span> HttpResponse(data)</div></pre></td></tr></table></figure>
<h5 id="画线"><a href="#画线" class="headerlink" title="画线"></a>画线</h5><ul>
<li>起始位置的坐标</li>
<li>两种颜色</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">draw.line((<span class="number">15</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">50</span>), fill=<span class="string">'red'</span>)</div><div class="line">   draw.line((<span class="number">45</span>, <span class="number">20</span>, <span class="number">100</span>, <span class="number">100</span>), fill=(<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>))</div></pre></td></tr></table></figure>
<h5 id="画圆"><a href="#画圆" class="headerlink" title="画圆"></a>画圆</h5><ul>
<li>找到两点，长方形中画圆的大小</li>
<li>角度0,90/0，180</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">draw.arc((<span class="number">0</span>,<span class="number">0</span>,<span class="number">30</span>,<span class="number">30</span>),<span class="number">0</span>,<span class="number">360</span>,fill=<span class="string">"red"</span>)</div></pre></td></tr></table></figure>
<h5 id="写文字及字体"><a href="#写文字及字体" class="headerlink" title="写文字及字体"></a>写文字及字体</h5><ul>
<li>坐标</li>
<li>文字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">draw.text([<span class="number">0</span>, <span class="number">0</span>], <span class="string">'python'</span>, <span class="string">"red"</span>)</div></pre></td></tr></table></figure>
<p>引入字体对象 import ImageFont</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">font = ImageFont.truetype(<span class="string">"kumo.ttf"</span>, <span class="number">28</span>)  <span class="comment"># 字体及字体大小</span></div><div class="line">draw.text([<span class="number">0</span>, <span class="number">0</span>], <span class="string">'python'</span>, <span class="string">"red"</span>,font=font)</div></pre></td></tr></table></figure>
<p><strong> 5 绘制随机字符 随机颜色</strong></p>
<ul>
<li>[i*24, 0] 总长是120 5个字符</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> random</div><div class="line"></div><div class="line">  <span class="comment"># char_list = []</span></div><div class="line">  <span class="comment"># for i in range(5):</span></div><div class="line">  <span class="comment">#     char = chr(random.randint(65,90))</span></div><div class="line">  <span class="comment">#     char_list.append(char)</span></div><div class="line">  <span class="comment">#     ''.join(char_list)</span></div><div class="line"></div><div class="line">  <span class="comment"># v =''.join([chr(random.randint(65,90)) for i in range(5)])</span></div><div class="line">  char_list = []</div><div class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</div><div class="line">      char = chr(random.randint(<span class="number">65</span>,<span class="number">90</span>))</div><div class="line">      char_list.append(char)</div><div class="line">      font = ImageFont.truetype(<span class="string">"kumo.ttf"</span>, <span class="number">28</span>)  <span class="comment"># 字体及字体大小</span></div><div class="line">      draw.text([i*<span class="number">24</span>, <span class="number">0</span>], char,(random.randint(<span class="number">0</span>,<span class="number">255</span>) ,random.randint(<span class="number">0</span>,<span class="number">255</span>) ,random.randint(<span class="number">0</span>,<span class="number">255</span>)),font=font)</div><div class="line"></div><div class="line">  img.save(f,<span class="string">'png'</span>)</div><div class="line">  data = f.getvalue()  <span class="comment"># 从内存中获取数据</span></div><div class="line"></div><div class="line">  <span class="keyword">return</span> HttpResponse(data)</div></pre></td></tr></table></figure>
<p><strong>6 通过session保存</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">char_list = []</div><div class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</div><div class="line">       char = chr(random.randint(<span class="number">65</span>,<span class="number">90</span>))</div><div class="line">       char_list.append(char)</div><div class="line">       font = ImageFont.truetype(<span class="string">"kumo.ttf"</span>, <span class="number">28</span>)  <span class="comment"># 字体及字体大小</span></div><div class="line">       draw.text([i*<span class="number">24</span>, <span class="number">0</span>], char,(random.randint(<span class="number">0</span>,<span class="number">255</span>) ,random.randint(<span class="number">0</span>,<span class="number">255</span>) ,random.randint(<span class="number">0</span>,<span class="number">255</span>)),font=font)</div><div class="line"></div><div class="line">   img.save(f,<span class="string">'png'</span>)</div><div class="line">   data = f.getvalue()  <span class="comment"># 从内存中获取数据</span></div><div class="line">   code  = <span class="string">''</span>.join(char_list)</div><div class="line">   request.session[<span class="string">'code'</span>] = code</div><div class="line"></div><div class="line">   <span class="keyword">return</span> HttpResponse(data)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(request)</span>:</span></div><div class="line">   <span class="keyword">if</span> request.method == <span class="string">"GET"</span>:</div><div class="line">       <span class="keyword">return</span> render(request, <span class="string">'login.html'</span>)</div><div class="line">   <span class="keyword">else</span>:</div><div class="line">       input_code = request.POST.get(<span class="string">'code'</span>)</div><div class="line">       session_code = request.session.get(<span class="string">'code'</span>)</div><div class="line">       <span class="keyword">if</span> input_code.upper() == session_code.upper(): <span class="comment"># 忽略大小写</span></div><div class="line">           <span class="keyword">pass</span></div><div class="line">       <span class="keyword">else</span>:</div><div class="line">           <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<p><strong>7 把验证码制作成一个模块</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</div><div class="line"><span class="keyword">from</span> utils.random_check_code <span class="keyword">import</span> rd_check_code</div><div class="line">img, code =rd_check_code() <span class="comment"># 返回值是img 和code</span></div><div class="line">stream = BytesIO()</div><div class="line">img.save(stream,<span class="string">'png'</span>)</div><div class="line">request.session[<span class="string">'code'</span>] = code</div><div class="line"><span class="keyword">return</span> HttpResponse(stream.getvalue())</div></pre></td></tr></table></figure>
<h3 id="注册页面"><a href="#注册页面" class="headerlink" title="注册页面"></a>注册页面</h3><p>注册页面使用了Form组件进行验证，功能</p>
<ul>
<li>在前端生成HTML标签，保留输入的信息</li>
<li>对输入的内容进行验证</li>
</ul>
<h4 id="Form组件"><a href="#Form组件" class="headerlink" title="Form组件"></a>Form组件</h4><p>把输入Form的类专门写到了app01的forms.py中。</p>
<ul>
<li>在form中验证验证码，需要request.session，但是form中没有</li>
<li>用super重写类的<strong>init</strong>()方法，把request作为参数传入RegisterForm类中，</li>
<li>在clean_字段()函数中，通过验证后，返回值是那个字段或者是<br>return input_code  # 验证通过把自身返回 return self.cleaned_data[‘code’]</li>
<li>在clean()中对总体的进行验证，通过验证的返回值是<strong>None</strong>或者是<strong>return self.cleaned_data</strong></li>
</ul>
<p>下面是源码中的实现：</p>
<p>查看add_eror:<code>forms.py-&gt;add_error-&gt;NON_FIELD_ERRORS</code>,跳转到exceptions.py中<code>NON_FIELD_ERRORS = &#39;__all__&#39;</code>,最终错误信息会保存在<strong>all</strong>中</p>
<p>通过验证后，返回None或者self.cleaned_data</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_clean_form</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        cleaned_data = self.clean()</div><div class="line">    <span class="keyword">except</span> ValidationError <span class="keyword">as</span> e:</div><div class="line">        self.add_error(<span class="keyword">None</span>, e)  <span class="comment"># 没有通过验证把错误信息放到None中，实际是在__all__中</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">if</span> cleaned_data <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</div><div class="line">            self.cleaned_data = cleaned_data</div></pre></td></tr></table></figure>
<ul>
<li>clean的没有通过验证后抛出的错误是</li>
<li>下面在在验证两次密码的时候，通过验证的返回值可以是None，因为不用获取通过验证的信息</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.forms <span class="keyword">import</span> Form</div><div class="line"><span class="keyword">from</span> django.forms <span class="keyword">import</span> fields</div><div class="line"><span class="keyword">from</span> django.forms <span class="keyword">import</span> widgets</div><div class="line"><span class="keyword">from</span> app01 <span class="keyword">import</span> models</div><div class="line"><span class="keyword">from</span> django.core.exceptions <span class="keyword">import</span> ValidationError</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegisterForm</span><span class="params">(Form)</span>:</span></div><div class="line">    username = fields.CharField(</div><div class="line">        widget=widgets.TextInput(attrs=&#123;<span class="string">'class'</span>: <span class="string">'form-control'</span>, <span class="string">'placeholder'</span>: <span class="string">"用户名"</span>&#125;)</div><div class="line">    )</div><div class="line">    password = fields.CharField(</div><div class="line">        widget=widgets.PasswordInput(attrs=&#123;<span class="string">'class'</span>: <span class="string">'form-control'</span>, <span class="string">'placeholder'</span>: <span class="string">"密码"</span>&#125;)</div><div class="line">    )</div><div class="line">    password2 = fields.CharField(</div><div class="line">        widget=widgets.PasswordInput(attrs=&#123;<span class="string">'class'</span>: <span class="string">'form-control'</span>, <span class="string">'placeholder'</span>: <span class="string">"确认密码"</span>&#125;)</div><div class="line">    )</div><div class="line">    avatar = fields.FileField(</div><div class="line">        widget=widgets.FileInput(</div><div class="line">            attrs=&#123;<span class="string">'id'</span>: <span class="string">'imgSelect'</span>, <span class="string">'class'</span>: <span class="string">'f1'</span>&#125;</div><div class="line">        )</div><div class="line">    )</div><div class="line">    code = fields.CharField(</div><div class="line">        widget=widgets.TextInput(</div><div class="line">            attrs=&#123;<span class="string">'class'</span>: <span class="string">'form-control'</span>, <span class="string">'placeholder'</span>: <span class="string">"验证码"</span>&#125;</div><div class="line">        )</div><div class="line">    )</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, request, *args, **kwargs)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        在form中验证验证码，需要request.session，但是form中没有，</div><div class="line">        用super重写类的__init__()方法，把request作为参数传入RegisterForm类中，</div><div class="line">        :param request:</div><div class="line">        :param args:</div><div class="line">        :param kwargs:</div><div class="line">        """</div><div class="line">        super(RegisterForm, self).__init__(*args, **kwargs)</div><div class="line">        self.request = request</div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean_code</span><span class="params">(self)</span>:</span></div><div class="line">        input_code = self.cleaned_data[<span class="string">'code'</span>]  <span class="comment"># 从验证的code中获取输入的验证码</span></div><div class="line">        session_code = self.request.session.get(<span class="string">'code'</span>)  <span class="comment"># 从session中获取验证码</span></div><div class="line">        <span class="keyword">if</span> input_code.upper() == session_code.upper():</div><div class="line">            <span class="keyword">return</span> input_code  <span class="comment"># 验证通过把自身返回 return self.cleaned_data['code']</span></div><div class="line">        <span class="keyword">raise</span> ValidationError(<span class="string">"验证码错误"</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">clean</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="string">"""</span></div><div class="line">        总体验证</div><div class="line">        下面对两次密码进行验证</div><div class="line">        :return:</div><div class="line">        """</div><div class="line">        pwd1 = self.cleaned_data.get(<span class="string">'password'</span>)</div><div class="line">        pwd2 = self.cleaned_data.get(<span class="string">'password2'</span>)</div><div class="line">        <span class="keyword">if</span> pwd1 == pwd2:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span>  <span class="comment"># 或者是return self.cleaned_data  因为不用获取通过验证后的密码信息</span></div><div class="line">        self.add_error(<span class="string">"password2"</span>,ValidationError(<span class="string">"两次密码不一致"</span>))  <span class="comment"># 指定在password2字段中的抛出错误</span></div><div class="line">        <span class="comment"># 第一个参数是None的时候，错误信息会加入__all__中</span></div></pre></td></tr></table></figure>
<ul>
<li>和后台用obj.errors[‘<strong>all</strong>‘]和obj.errors[NON_FIELD_ERRORS]都能打印错误</li>
<li>但是前端要用obj.non_field_errors  <strong>没有errors，小写的non_field_errors</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(request)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    用户注册</div><div class="line">    :param request:</div><div class="line">    :return:</div><div class="line">    """</div><div class="line">    <span class="keyword">if</span> request.method == <span class="string">"GET"</span>:</div><div class="line">        obj = RegisterForm(request)  <span class="comment"># 自己重写了类的__init__()方法 向类中传入参数request</span></div><div class="line">        <span class="keyword">return</span> render(request, <span class="string">'register.html'</span>, &#123;<span class="string">'obj'</span>: obj&#125;)</div><div class="line"></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        obj = RegisterForm(request,request.POST,request.FILES) <span class="comment"># 也要添加参数request</span></div><div class="line">        print(<span class="string">'......'</span>)</div><div class="line">        <span class="keyword">if</span> obj.is_valid():</div><div class="line">            <span class="keyword">pass</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            print(obj.errors[<span class="string">'__all__'</span>])  <span class="comment"># 没有通过验证打印错误&lt;ul class="errorlist nonfield"&gt;&lt;li&gt;两次密码不一致&lt;/li&gt;&lt;/ul&gt;</span></div><div class="line">            print(obj.errors[NON_FIELD_ERRORS])  <span class="comment"># 打印错误&lt;ul class="errorlist nonfield"&gt;&lt;li&gt;两次密码不一致&lt;/li&gt;&lt;/ul&gt;</span></div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'register.html'</span>, &#123;<span class="string">'obj'</span>: obj&#125;)</div></pre></td></tr></table></figure>
<p><strong>指定固定字段的错误</strong></p>
<p>把None替换成password2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">clean</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    总体验证</div><div class="line">    下面对两次密码进行验证</div><div class="line">    :return:</div><div class="line">    """</div><div class="line">    pwd1 = self.cleaned_data.get(<span class="string">'password'</span>)</div><div class="line">    pwd2 = self.cleaned_data.get(<span class="string">'password2'</span>)</div><div class="line">    <span class="keyword">if</span> pwd1 == pwd2:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span>  <span class="comment"># 或者是return self.cleaned_data</span></div><div class="line">    self.add_error(<span class="string">"password2"</span>, ValidationError(<span class="string">"两次密码不一致"</span>)) <span class="comment"># 指定在password2字段中的抛出错误</span></div></pre></td></tr></table></figure>
<p><strong>前端有两种形式</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; obj.code &#125;&#125; &#123;&#123; obj.non_field_errors &#125;&#125;</div><div class="line">或者</div><div class="line">&#123;&#123; obj.code &#125;&#125; &#123;&#123; obj.errors.code.0 &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>obj.errors是下面的字典数据<br>“””<br>{<br>    <strong>all</strong>: [错误1，错误2]<br>    user: [错误1，错误2]<br>    password: [错误1，错误2]<br>}<br>“””</p>
<h4 id="验证码验证-并点击刷新验证码"><a href="#验证码验证-并点击刷新验证码" class="headerlink" title="验证码验证 并点击刷新验证码"></a>验证码验证 并点击刷新验证码</h4><p>刷新验证码的原理，在URL后面添加？会重新提交请求</p>
<p>给验证码图片绑定onclick事件，传入了this参数</p>
<p>function中的参数不能用this，所以用了ths,ths就代表了当前点击的对象<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-5"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">onclick</span>=<span class="string">"changeCode(this);"</span> <span class="attr">title</span>=<span class="string">"点击更新图片"</span> <span class="attr">style</span>=<span class="string">"width: 120px;height: 30px;"</span> <span class="attr">src</span>=<span class="string">"/check_code/"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">changeCode</span>(<span class="params">ths</span>) </span>&#123;</div><div class="line">        ths.src = ths.src + <span class="string">"?"</span>;<span class="comment">// 在URL后面添加？会重新提交请求，实现刷新图片</span></div><div class="line">    &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h4 id="头像预览"><a href="#头像预览" class="headerlink" title="头像预览"></a>头像预览</h4><p>头像上传的情况，用户上传了但是没有注册</p>
<p>设置默认头像，路径固定，更新头像的时候替换图片</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"upload_img"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"previewImg"</span> <span class="attr">src</span>=<span class="string">"/static/images/default.jpg"</span> <span class="attr">title</span>=<span class="string">"点击上传头像"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="selector-id">#imgSelect</span>&#123;</div><div class="line">    <span class="comment">/*</span></div><div class="line">    设置上传标签的大小和位置</div><div class="line">    关键是在在上面zindex</div><div class="line">    透明度设置成0</div><div class="line">    */</div><div class="line">    <span class="attribute">position</span>: absolute;</div><div class="line">    <span class="attribute">height</span>: <span class="number">70px</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">80px</span>;</div><div class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">z-index</span>:<span class="number">100</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>1 图片上传到浏览器</strong></p>
<p>需要浏览器的兼容性</p>
<h5 id="window-URL-createObjectURL"><a href="#window-URL-createObjectURL" class="headerlink" title="window.URL.createObjectURL"></a>window.URL.createObjectURL</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindAvatar2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">$(<span class="string">'#imgSelect'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> obj = $(<span class="keyword">this</span>)[<span class="number">0</span>].files[<span class="number">0</span>];<span class="comment">//js对象转换成DOM对象 这是文件对象</span></div><div class="line">    <span class="keyword">var</span> v = <span class="built_in">window</span>.URL.createObjectURL(obj); <span class="comment">// 把文件对象传入，文件会缓存在浏览器中，同时生成一个浏览器URL</span></div><div class="line">    $(<span class="string">'#previewImg'</span>).attr(<span class="string">'src'</span>,v);<span class="comment">// 用浏览器内部的URL替换原来的默认图片路径</span></div><div class="line">    $(<span class="string">'#previewImg'</span>).load(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">window</span>.URL.revokeObjectURL(v); <span class="comment">// 上传的图片路径不会清空，这里手动清空</span></div><div class="line">    &#125;)</div><div class="line">&#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="readAsDataURL"><a href="#readAsDataURL" class="headerlink" title="readAsDataURL"></a>readAsDataURL</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindAvatar3</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    $(<span class="string">'#imgSelect'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> obj =$(<span class="keyword">this</span>)[<span class="number">0</span>].files[<span class="number">0</span>];</div><div class="line">        <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</div><div class="line">        reader.onload = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">            $(<span class="string">'#previewImg'</span>).attr(<span class="string">'src'</span>,<span class="keyword">this</span>.result);</div><div class="line">        &#125;;</div><div class="line">        reader.readAsDataURL(obj);</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>2 图片上传到服务器的临时路径，之后保存到固定路径</strong></p>
<p>使用ajax上传<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">ajax上传:</div><div class="line">使用change，当图片改变的时候触发函数</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindAvata1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">   $(<span class="string">'#imgSelect'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">       <span class="keyword">var</span> obj = $(<span class="keyword">this</span>)[<span class="number">0</span>].files[<span class="number">0</span>];<span class="comment">//js对象转换成DOM对象</span></div><div class="line">       <span class="comment">// Ajax发送后台，并获取路径</span></div><div class="line">       <span class="comment">// img.src = 获取路径</span></div><div class="line">   &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>3 浏览器的兼容代码</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/jquery-1.12.4.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">changeCode</span>(<span class="params">ths</span>) </span>&#123;</div><div class="line">            ths.src = ths.src + <span class="string">"?"</span>;<span class="comment">// 在URL后面添加？会重新提交请求，实现刷新图片</span></div><div class="line">        &#125;</div><div class="line">        $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            bindAvatar();  <span class="comment">//入口函数</span></div><div class="line">        &#125;);</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bindAvatar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="comment">/*</span></div><div class="line">            浏览器兼容性</div><div class="line">            如果浏览器有window.URL.createObjectURL这个对象,执行bindAvatar2</div><div class="line">            如果浏览器有window.FileReader对象，执行 bindAvatar3();</div><div class="line">            最后其他的浏览器执行ajax的上传</div><div class="line">             */</div><div class="line">            <span class="keyword">if</span>(<span class="built_in">window</span>.URL.createObjectURL)&#123;</div><div class="line">                bindAvatar2();</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.FileReader)&#123;</div><div class="line">                 bindAvatar3();</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                bindAvatar1();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">/*</span></div><div class="line">         ajax上传:</div><div class="line">         使用change，当图片改变的时候触发函数</div><div class="line">         */</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bindAvatar1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">'#imgSelect'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">var</span> obj = $(<span class="keyword">this</span>)[<span class="number">0</span>].files[<span class="number">0</span>];<span class="comment">//js对象转换成DOM对象</span></div><div class="line">                <span class="comment">// Ajax发送后台，并获取路径</span></div><div class="line">                <span class="comment">// img.src = 获取路径</span></div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">        <span class="comment">/*</span></div><div class="line">         本地上传预览</div><div class="line">         */</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bindAvatar2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">'#imgSelect'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">var</span> obj = $(<span class="keyword">this</span>)[<span class="number">0</span>].files[<span class="number">0</span>];<span class="comment">//js对象转换成DOM对象 这是文件对象</span></div><div class="line">                <span class="keyword">var</span> v = <span class="built_in">window</span>.URL.createObjectURL(obj); <span class="comment">// 把文件对象传入，文件会缓存在浏览器中，同时生成一个浏览器URL</span></div><div class="line">                $(<span class="string">'#previewImg'</span>).attr(<span class="string">'src'</span>,v);<span class="comment">// 用浏览器内部的URL替换原来的默认图片路径</span></div><div class="line">                $(<span class="string">'#previewImg'</span>).load(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                    <span class="built_in">window</span>.URL.revokeObjectURL(v); <span class="comment">// 上传的图片路径不会清空，这里手动清空</span></div><div class="line">                &#125;)</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bindAvatar3</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $(<span class="string">'#imgSelect'</span>).change(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">var</span> obj =$(<span class="keyword">this</span>)[<span class="number">0</span>].files[<span class="number">0</span>];</div><div class="line">                <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</div><div class="line">                reader.onload = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">                    $(<span class="string">'#previewImg'</span>).attr(<span class="string">'src'</span>,<span class="keyword">this</span>.result);</div><div class="line">                &#125;;</div><div class="line">                reader.readAsDataURL(obj);</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>5 ajax上传的时候设置csrf</strong></p>
<p>ajax上传的时候需要把随机字符串发送给后台，隐藏在页面中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input type=&apos;hidden&apos; name=&apos;csrfmiddlewaretoken&apos; value=&apos;u5j5YY4Z6h4QbvdfHypqyVekCjcPNpdyqEyUDZdW6UM4aK0DEu6PuhGMiOm2AMPQ&apos; /&gt;</div></pre></td></tr></table></figure>
<p>有两种方式进行发送：</p>
<h4 id="1-通过从页面获取csrfmiddlewaretoken-在数据中发送"><a href="#1-通过从页面获取csrfmiddlewaretoken-在数据中发送" class="headerlink" title="1 通过从页面获取csrfmiddlewaretoken,在数据中发送"></a>1 通过从页面获取csrfmiddlewaretoken,在数据中发送</h4><p>但是这里是通过formdata对象发送的，把csrf_token添加到data中挺复杂，不推荐使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$.ajax(&#123;</div><div class="line">    var csrf_token = $('input[name="csrfmiddlewaretoken"]').val();</div><div class="line">    url:'/.../',</div><div class="line">    type:'POST',</div><div class="line">    data:&#123;'csrfmiddlewaretoken':csrf_token&#125;, // 这里的key是csrfmiddlewaretoken</div><div class="line">    success:function(arg)&#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h4 id="2-使用jquery-cookie-js-把-X-CSRFToken写请求头进行发送"><a href="#2-使用jquery-cookie-js-把-X-CSRFToken写请求头进行发送" class="headerlink" title="2 使用jquery.cookie.js 把 X-CSRFToken写请求头进行发送"></a>2 使用jquery.cookie.js 把 X-CSRFToken写请求头进行发送</h4><p><img src="http://images2015.cnblogs.com/blog/658994/201707/658994-20170714195708868-1114842692.jpg" alt=""></p>
<p>Django接收后会进行处理，这里的与页面的是不一致的，Django在后台应该是转换，判断是否和发送到前端的是否一致。</p>
<ul>
<li>使用jquery.cookie.js获取浏览器的cookie，引入jquery.cookie.js文件</li>
<li><code>headers:{&#39;X-CSRFToken&#39;: token},</code> // 在请求头中发送X-CSRFToken，Django自动接收</li>
<li>var token = $.cookie(‘csrftoken’); // 通过cookie获取csrftoken</li>
<li>csrftoken是保存在cookie中的名字</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/jquery-1.12.4.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/static/jquery.cookie.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line">        /*</div><div class="line">         ajax上传:</div><div class="line">         使用change，当图片改变的时候触发函数</div><div class="line">         */</div><div class="line">        function bindAvatar1() &#123;</div><div class="line">            $('#imgSelect').change(function () &#123;</div><div class="line">                var formData = new FormData(); //用一个FormData对象发送</div><div class="line">&#123;#                var obj = $(this)[0].files[0];//js对象转换成DOM对象#&#125;</div><div class="line">                formData.append('upload_file',$('#imgSelect')[0].files[0]); // 使用jQuery获取文件对象</div><div class="line">                // Ajax发送后台，并获取路径</div><div class="line">                // img.src = 获取路径</div><div class="line">&#123;#                var csrf_val = $('input[name="csrfmiddlewaretoken"]').val();#&#125;</div><div class="line">                var token = $.cookie('csrftoken'); // 通过cookie获取csrftoken</div><div class="line">                $.ajax(&#123;</div><div class="line">                    url:'/register/',</div><div class="line">                    type:'POST',</div><div class="line">                    headers:&#123;'X-CSRFToken': token&#125;, // 在请求头中发送X-CSRFToken，Django自动接收</div><div class="line">                    data:formData,</div><div class="line">                    contentType:false,</div><div class="line">                    processData:false,</div><div class="line">                    success:function (arg) &#123;</div><div class="line">                        var new_img_url = $('#previewImg').src ='/'+ arg; // 返回值args就是文件路径  静态文件路径的开头有 斜杠</div><div class="line">                        $('#previewImg').attr('src',new_img_url);</div><div class="line">                    &#125;</div><div class="line">                &#125;)</div><div class="line">            &#125;)</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div></pre></td><td class="code"><pre><div class="line">Bootstrap 导航条</div><div class="line">修改 css radius=0  !important</div><div class="line"></div><div class="line">栅格 左右划分</div><div class="line">col-md-8</div><div class="line"></div><div class="line">头像浮动 left</div><div class="line"></div><div class="line"></div><div class="line">clearfix 清除浮动  相当于在后面 加上了 div中的clear both</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">文章筛选：</div><div class="line">PYthon Linux ...</div><div class="line"></div><div class="line">	从URL进行修改</div><div class="line">	 全部</div><div class="line">	 Python</div><div class="line">	 Linux</div><div class="line"></div><div class="line">  选中的</div><div class="line"></div><div class="line">获取当前URL</div><div class="line">request.path_info</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">登录界面</div><div class="line"></div><div class="line">name属性</div><div class="line"></div><div class="line"></div><div class="line">col-sm-5宽度</div><div class="line"></div><div class="line">验证码的本质是Django从硬盘读取到文件</div><div class="line"></div><div class="line">读取的时候用rb,HTTPresponse返回</div><div class="line"></div><div class="line">Pillow创建图片</div><div class="line">图片对象</div><div class="line"></div><div class="line"></div><div class="line">验证码直接用，不存放硬盘</div><div class="line"></div><div class="line">from io import BytesIO</div><div class="line"></div><div class="line">在内存开辟空间</div><div class="line"></div><div class="line">画图</div><div class="line"></div><div class="line">	点</div><div class="line">	线</div><div class="line">	原型</div><div class="line">	字体</div><div class="line">		特殊字体</div><div class="line"></div><div class="line"> v = random.randint()</div><div class="line"> chr(v)</div><div class="line"></div><div class="line"> 把验证码保存在session中</div><div class="line"></div><div class="line"></div><div class="line">  头像在浏览器上预览</div><div class="line">	- window.url</div><div class="line">	- </div><div class="line">forms 单独写一个文件</div><div class="line"></div><div class="line"></div><div class="line">自己在form的类中自定义</div><div class="line"></div><div class="line">通过构造方法，封装 request</div><div class="line">self.__init():</div><div class="line"></div><div class="line">super()</div><div class="line"></div><div class="line"></div><div class="line">两个验证码放在clean中</div><div class="line"></div><div class="line">两次不一致最后的错误信息</div><div class="line"></div><div class="line">clean的错误放在__all__ 公共的错误</div><div class="line"></div><div class="line">obj.errors.__all__  后台可以取</div><div class="line">但是前端不支持下划线</div><div class="line"></div><div class="line"></div><div class="line">NON_FIELD_ERRORS  后台可以取</div><div class="line"></div><div class="line">前端用小写的**obj.non_field_errors**,没有errors</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">自己主动对某一字段抛出异常</div><div class="line">self.add_error(&quot;字段名&quot;，Validationerror)</div><div class="line"></div><div class="line"></div><div class="line">验证码点击刷新</div><div class="line"></div><div class="line">在utl后面加？刷新  图片名字title ：点击刷新</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">每个人的个人主页是不用登陆</div><div class="line"></div><div class="line"></div><div class="line">一对一</div><div class="line"></div><div class="line">正向 反向和FK一致</div><div class="line"></div><div class="line">反向还可以直接找</div><div class="line"></div><div class="line"></div><div class="line">### 博客个人分类</div><div class="line"></div><div class="line"></div><div class="line">annotate聚合函数需要导入</div><div class="line"></div><div class="line">values+annotate 实现group by</div><div class="line"></div><div class="line">双下划线跨表操作</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">#### 标签分类</div><div class="line"></div><div class="line">标签和文章是多对多的关系</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Django/">Django</a></li></ul>

      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-Form组件的扩展 钩子"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/07/09/Form组件的扩展 钩子/">Form组件的验证流程及扩展(钩子)</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/07/09/Form组件的扩展 钩子/" class="article-date">
	  <time datetime="2017-07-09T08:58:16.246Z" itemprop="datePublished">七月 9, 2017</time>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        

          
            <div class="entry-summary" style="margin-left:0;">
            Form组件的验证流程及扩展(钩子)常用的form
1234567891011121314151617181920212223class TestForm(Form):    t1 = fields.CharField(        widget=widgets.Textarea  # 输入框    )    t2 = fields.CharField(        widget=widgets.CheckboxInput  # 单选框    )    t3 = fields.MultipleChoiceField(        choices=[(1, '篮球'), (2, '足球')],  # 多选框的内容        widget=widgets.CheckboxSele...
          

        
          <p class="article-more-link">
            <a href="/2017/07/09/Form组件的扩展 钩子/#more">阅读全文</a>
          </p>
        </div>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Django/">Django</a></li></ul>

      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-Ajax的原理及Django上传"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/07/09/Ajax的原理及Django上传/">Ajax的原理及Django上传组件</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/07/09/Ajax的原理及Django上传/" class="article-date">
	  <time datetime="2017-07-09T04:36:25.864Z" itemprop="datePublished">七月 9, 2017</time>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        

          
            <div class="entry-summary" style="margin-left:0;">
            Ajax的原理及Django上传组件Ajax的原理
ajax 是异步JavaScript和xml
ajax就是向后台提交数据但是不刷新页面
原生Ajax XMLHttprequest
创建一个XMLHttprequest对象
回调函数onreadystatechange 对应jQuery中的success
状态值是不断变化的，4代表完成，已经接收到全部响应数据；
open是创建请求
send是发送数据

XMLHttprequest对象的主要方法:123456789101112131415161718192021222324252627282930313233343536373839a. void open(String method,String url,Boolen async) ...
          

        
          <p class="article-more-link">
            <a href="/2017/07/09/Ajax的原理及Django上传/#more">阅读全文</a>
          </p>
        </div>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Django/">Django</a></li></ul>

      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-CORS的原理及应用"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/07/09/CORS的原理及应用/">CORS的原理及应用</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2017/07/09/CORS的原理及应用/" class="article-date">
	  <time datetime="2017-07-09T02:17:59.529Z" itemprop="datePublished">七月 9, 2017</time>
	</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        

          
            <div class="entry-summary" style="margin-left:0;">
            CORS的原理及应用
CORS是跨站资源共享，同样是解决浏览器的同源策略
其本质是设置响应头，使得浏览器允许跨域请求。
第三方网站返回数据的时候在浏览器的响应头中添加允许的域名，允许所有的用*   
1 简单请求
简单请求是只发一次请求
ajax请求不变，第三方后台修改
s4的后台，在返回值中添加允许的域名和端口，注意不同后面写具体的域名，自己出错是在后面加上了cors
允许所有的，用*
123456789101112def new_users(request):    print('请求is coming')    user_list = [        'aaa',        'bbb',        'ccc'    ]    user_list_str = json.d...
          

        
          <p class="article-more-link">
            <a href="/2017/07/09/CORS的原理及应用/#more">阅读全文</a>
          </p>
        </div>
      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Django/">Django</a></li></ul>

      
    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
  </nav>

</section>
          <aside id="sidebar">
  
    <div class="widget-wrap" style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 75%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 42px;" placeholder=" 搜索…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="搜索">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">联系我们</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
   			<li><a href="https://github.com/ythzx/ythzx.github.io" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="https://weibo.com/" title="Weibo"><i class="fa fa-weibo" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="https://www.twitter.com/" title="Twitter"><i class="fa fa-twitter" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="https://www.facebook.com/" title="Facebook"><i class="fa fa-facebook" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="https://:www.google.com/" title="Google-plus"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="https://www.instagram.com/" title="Instagram"><i class="fa fa-instagram" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="null" title="Pinterest"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li> 

   		
   			<li><a href="null" title="Flickr"><i class="fa fa-flickr" aria-hidden="true"></i></a></li> 

   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>最新文章</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/07/10/多表操作/">Django models多表操作</a></h6>
              <span>七月 10, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/07/10/博客项目文档/">Django博客项目</a></h6>
              <span>七月 10, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/07/09/Form组件的扩展 钩子/">Form组件的验证流程及扩展(钩子)</a></h6>
              <span>七月 9, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/07/09/Ajax的原理及Django上传/">Ajax的原理及Django上传组件</a></h6>
              <span>七月 9, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/07/09/CORS的原理及应用/">CORS的原理及应用</a></h6>
              <span>七月 9, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/2017/07/07/JSONP 技术/">JSONP的原理及应用</a></h6>
              <span>七月 7, 2017</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/">Django</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">40</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sublime/">Sublime</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/">Web</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Django/" style="font-size: 18px;">Django</a> <a href="/tags/JavaScript/" style="font-size: 14px;">JavaScript</a> <a href="/tags/Linux/" style="font-size: 16px;">Linux</a> <a href="/tags/MySQL/" style="font-size: 12px;">MySQL</a> <a href="/tags/Python/" style="font-size: 20px;">Python</a> <a href="/tags/Sublime/" style="font-size: 10px;">Sublime</a> <a href="/tags/Web/" style="font-size: 12px;">Web</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/web/" style="font-size: 10px;">web</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">25</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">18</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2017 Peter&#39;s Blog Center All Rights Reserved.
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>






<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?93b40df12317201527431272f20ac28a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
  

  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>


  <script type="text/javascript" color="33,33,33" zindex="-1" opacity="1" count="80" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
